---
title:  "Excel VBA Reference"
date:   2018-01-15
image: "/excel-vba/excel.png"
---
Excel's VBA function allows the user to enhance a workbook by allowing them to automate and manipulate elements and tasks into the excel workbook. Excel uses the programing language visual basic which is an event-driven programming language that is user friendly and specifically for beginners. I remember when I first used VBA to automate formatting of data, with a push of the button I saved 15 minutes every day.

<br>

### Table of Contents
 1. [Developer](#dev)
 - [Developer Tab](#devtab)
 2. [Range](#range)
 - [Range Object](#rangeobj)
 - [Creating a Macro](#firstmacro)
 - [Debugging](#debug)
 - [Saving Macro](#save)
 - [Executing Macro](#trigger)
 - [Multiple Cells One Range](#multirange)
 - [Named Range](#namerange)
 3. [Range Properties](#rangeprop)
 - [Value](#valueprop)
 - [Text](#textprop)
 - [Row & Column](#rowcol)
 - [Select](#select)
 - [Count](#count)
 - [Address](#address)
 - [Formula](#formula)
 - [Number Formatter](#numformat)
 - [Font Bold, Underline, Italic](#font)
 4. [Cells](#cell)
 - [Cells Object](#cellobj)
 - [Cells Position](#poscell)
 - [Select All Cells](#cellall)
 - [Range with Cells](#rangecell)
 5. [Variables](#variable)
 - [Variable Types](#vartypes)
 - [Declaring Variable](#decvar)
 - [Calling A Procedure](#callpro)
 - [Public/Private](#pubpriv)
 - [Constants](#constants)
 - [Concatenate Strings](#concat)
 - [Pass By Value/Reference](#valref)
 6. [Editor Toolbars and Menus](#toolmenu)
 - [File Menu](#file)
 - [Edit Menu](#edit)
 - [View Menu](#view)
 - [Debug Menu](#dbug)
 7. [VBA Logic](#logic)
 - [Find Last Row](#lastrow)
 - [Find Last Column](#lastcolumn)
 - [Find Next Row](#nextrow)
 - [Record Macro](#macro)
 - [Absolute vs Relative Reference](#abrelref)


 <br>

### Developer <a name="dev"></a>
#### Developer Tab <a name="devtab"></a>
To enable the developer tab go to `File` --> `Options` --> `Customize Ribbon` --> check `Developer` box --> `OK`.

<figure>
  <img src="/img/posts/excel-vba/dev_tab.jpg" class="blg-img" alt="Dev Tab">
  <figcaption>Enable the developer tab</figcaption>
</figure>

<br>

### Range <a name="range"></a>
#### Range Object <a name="rangeobj"></a>
The range object is the rows and columns of the element(s). For instance, if I have highlighted the first cell it would be a range of `A1`. If I highlighted the first three columns and first three rows it would be a range of `A1:C3`. For multiple columns you just take the first element `:` then the last element in range.

<figure>
  <img src="/img/posts/excel-vba/rangeobj.jpg" class="blg-img" alt="Sample Range Object">
  <figcaption>Range of B2:E6</figcaption>
</figure>

<br>

#### Creating a Macro<a name="firstmacro"></a>
To open up the VBA developer IDE(Integrated Development Environment) use the shortcut key `alt`+`F11`. Alternatively you can go to the `Developer` tab and click on `Visual Basic`.

To write your code you need to create `modules`. Click on the icon `Insert Modules`, they look like skittles, then `Module`. You can have as many modules as you like.

<figure>
  <img src="/img/posts/excel-vba/add_module.jpg" class="blg-img" alt="Add module">
  <figcaption>Adding a module</figcaption>
</figure>

Your macro code will go in between `Sub MacroName()` and `End Sub` keywords. To specify a value to a specific cell use the `Range("rowcolumn") = value`.  To run the macro click play button (green triangle). You can also specify multiple cell ranges using the `:`. You can set value to strings using the `""` ex: `Range("a1") = "Hello World!"`

<figure>
  <img src="/img/posts/excel-vba/hello.jpg" class="blg-img" alt="First Macro">
  <figcaption>Coding and running macro</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/number.jpg" class="blg-img" alt="Multiple Cells">
  <figcaption>Multiple ranges</figcaption>
</figure>

You can stack multiple commands one right after each other. The compiler will read the code from top down.

<figure>
  <img src="/img/posts/excel-vba/multicommands.jpg" class="blg-img" alt="Multiple Commands">
  <figcaption>Multiple commands</figcaption>
</figure>

<br>

#### Debugging <a name="debug"></a>
You can debug each line of code in excel by using the `F8` key and watching one by one what happens to the workbook. As your code gets longer there maybe some logic error in your code that needs to be fixed; using the debugger tool will help assist you.

<figure>
  <img src="/img/posts/excel-vba/debug.jpg" class="blg-img" alt="Debugger">
  <figcaption>Debugger</figcaption>
</figure>

<br>

#### Saving Macro <a name="save"></a>
In order to save a macro workbook it needs to be saved with the `xlsm` file extension or else it will not work. So when saving the first time the save as type should be `Excel Macro-Enabled Workbook`.

<br>

#### Executing Macros <a name="trigger"></a>
- `alt` + `F11` and then click `play` then `run`
- on developer tab click `Macros` icon and then `select` macro and `run` (shortcut `alt` + `F8`)

There are more sophisticated ways such as clicking on a button or a specific cell etc..

<br>

#### Multiple Cells One Range <a name="multirange"></a>
You can set values to multiple cells in one range command ex: `Range("a1:c4, e3") = 15`.

<figure>
  <img src="/img/posts/excel-vba/multirange.jpg" class="blg-img" alt="Multiple Cells From One Range Command">
  <figcaption>Multiple cell values from one range commmand</figcaption>
</figure>

<br>

#### Named Range <a name="namerange"></a>
Instead of specifying specific rows and columns in a macro you can set the range to reference a named ranged.

<figure>
  <img src="/img/posts/excel-vba/tax_table.jpg" class="blg-img" alt="Named Range">
  <figcaption>Set a named range</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/named_range.jpg" class="blg-img" alt="Reference Named Range">
  <figcaption>Reference a named range</figcaption>
</figure>

<br>

### Range Properties <a name="rangeprop"></a>
#### Value <a name="valueprop"></a>
To access properties you use the `.` operator and a list of properties available should pop up. The value property gets the value for the range.

<figure>
  <img src="/img/posts/excel-vba/value.jpg" class="blg-img" alt="Value Property">
  <figcaption>Value property</figcaption>
</figure>

<br>

#### Text <a name="textprop"></a>
The text property gets the data as a string. If you don't specify a property the default is the value property.

<figure>
  <img src="/img/posts/excel-vba/text.jpg" class="blg-img" alt="Text Property">
  <figcaption>Text property</figcaption>
</figure>

<br>

#### Row and Column <a name="rowcol"></a>
The row and column property will return the row number and column number back in integer of the range.

<figure>
  <img src="/img/posts/excel-vba/row.jpg" class="blg-img" alt="Row Property">
  <figcaption>Row property</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/column.jpg" class="blg-img" alt="Column Property">
  <figcaption>Column property</figcaption>
</figure>

<br>

#### Select <a name="select"></a>
The select property sets the cursor location to the referenced name.

<figure>
  <img src="/img/posts/excel-vba/select.jpg" class="blg-img" alt="Select Property">
  <figcaption>Select property</figcaption>
</figure>

<br>

#### Count <a name="count"></a>
The count property counts how many cells are in the referenced range. Note it does not matter if their is data in the cell or not.

<figure>
  <img src="/img/posts/excel-vba/count.jpg" class="blg-img" alt="Count Property">
  <figcaption>Count property</figcaption>
</figure>

<br>

#### Address <a name="address"></a>
The address property of a range returns the location of the row and column as in excel ex: `A5`. You can specify if you want absolute paths of the row/column by specifying a 1 or 0; absolute includes the `$` sign.

<figure>
  <img src="/img/posts/excel-vba/address.jpg" class="blg-img" alt="Address Property">
  <figcaption>Address property</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/address2.jpg" class="blg-img" alt="Address Property No Absolute">
  <figcaption>Address property without absolute</figcaption>
</figure>

<br>

#### Formula <a name="formula"></a>
The formula property allows you to set a formula to a specific cell.

<figure>
  <img src="/img/posts/excel-vba/formula.jpg" class="blg-img" alt="Formula Property">
  <figcaption>Formula property</figcaption>
</figure>

<br>

#### Number Format <a name="numformat"></a>
The number format changes the format of the value from general to currency, accounting, date, time etc...

<figure>
  <img src="/img/posts/excel-vba/format.jpg" class="blg-img" alt="Number Formatter Property">
  <figcaption>Number formatter property</figcaption>
</figure>

<br>

#### Font Bold, Underline, Italic, Name, Size <a name="font"></a>
The font property you can change the style of the font but it takes a boolean (true/false) value. You can also use `Font.Name = "Font Name"` to change the font type. Also change the size by using `Font.Size = 12`.

<figure>
  <img src="/img/posts/excel-vba/font.jpg" class="blg-img" alt="Font Style Property">
  <figcaption>Number formatter property</figcaption>
</figure>

<br>

### Cells <a name="cell"></a>
#### Cells Object <a name="cellsobj"></a>
The cells object is similar to the range object but instead of a range you put in the cell coordinates as integers (row, column). This is great for looping through entire rows or columns. You can substitute the column numbers for letters but need to put them in `""`

<figure>
  <img src="/img/posts/excel-vba/cells.jpg" class="blg-img" alt="Cells Object">
  <figcaption>Cells object</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/cells2.jpg" class="blg-img" alt="Cells Object">
  <figcaption>Cells object with letter column</figcaption>
</figure>

<br>

#### Cell Position <a name="poscell"></a>
You can reference the cell's position by specifying the integer location. It starts with the row A1 = 1, B1 = 2, C1 = 3 etc. However, if you select a range and then use the `.` operator and use cell object it will only count within the referenced range.

<figure>
  <img src="/img/posts/excel-vba/poscell.jpg" class="blg-img" alt="Cell Position">
  <figcaption>Cell Position</figcaption>
</figure>

<br>

#### Select All Cells <a name="cellall"></a>
You can select every cell in the workbook by simply not referencing a specific cell; `Cells`.

<figure>
  <img src="/img/posts/excel-vba/cellall.jpg" class="blg-img" alt="Cell Position">
  <figcaption>Select all cells</figcaption>
</figure>

<br>

#### Range Object With Cell <a name="rangecell"></a>
Sometimes you will want to select from a specific cell to cell without hardcoding the range. You can do this by using `Cell(r,c)` as a parameter for the `Range()` object.

<figure>
  <img src="/img/posts/excel-vba/rangecell.jpg" class="blg-img" alt="Range object with cell">
  <figcaption>Using range object with the cell</figcaption>
</figure>

<br>

### Variables <a name="variable"></a>
#### Variable Types <a name="vartypes"></a>
The table below shows what data types are supported as well as their memory size.

<figure>
  <img src="/img/posts/excel-vba/data_types.jpg" class="blg-img" alt="List of data types">
</figure>

<br>

#### Declaring Variables <a name="decvar"></a>
You declare variables by using the keyword `dim` followed by `variable name` then keyword `as` followed by `data type`; `dim hello as String`, `dim x as Integer`. Once declared you assign a stored value by using the `=` operator.

<figure>
  <img src="/img/posts/excel-vba/vardemo.jpg" class="blg-img" alt="Declare and assign variables">
  <figcaption>Declare and assign variables</figcaption>
</figure>

<br>

#### Call A Procedure <a name="callpro"></a>
To call another procedure (function) use the `Call` keyword followed by the procedure's name, ex:`Call myMethod`. If there are variables declared within the called procedure then the values will be out of scope and not recognized by the compiler.

<figure>
  <img src="/img/posts/excel-vba/callpro.jpg" class="blg-img" alt="Call another procedure">
  <figcaption>Calling another procedure within a procedure</figcaption>
</figure>

<br>

#### Public and Private Variables <a name="pubpriv"></a>
When setting a variable as `Public` the variable will retain its data and can be used throughout any other module. When setting a variable as `Private` the variable can only be accessed only within the module it is initialized in.

<figure>
  <img src="/img/posts/excel-vba/pubpriv.jpg" class="blg-img" alt="Public and Private Variables">
  <figcaption>Declaring public and private variables</figcaption>
</figure>

<br>

#### Using Constants <a name="constants"></a>
Declare constants by using the `Const` keyword and you must assign data when declaring. Constants cannot be changed.
`Const PI as Double = 3.14`. You can also make the constants public or private.

<br>

#### Concatenate Strings <a name="concat"></a>
You can combine two or more strings by using the `&` symbol. This will also work to combine string variables. `text = "Hello " & "World!"`

<br>

#### Pass by Value vs Reference <a name="valref"></a>
When passing values into a procedure use the keywords `ByVal` & `ByRef` to specify how you are passing the variables through. By value means that only the value is being passed and will not change once the procedure is ended. By reference means that any changes made will change the original value.

<figure>
  <img src="/img/posts/excel-vba/refval.jpg" class="blg-img" alt="By reference and by value examples">
  <figcaption>ByVal does not change but ByRef does change</figcaption>
</figure>

<br>

### Editor Toolbars and Menu <a name="toolmenu"></a>
#### File Menu <a name="file"></a>
The file menu you have your basics save, print, remove. The `Remove module` will delete your file. You can `Export` your code and save it as a `.bas` file. You can also `Import` your written code from a .bas file.

<br>

#### Edit Menu <a name="edit"></a>
In the edit menu the `List Properties/Methods (ctrl + j)` will open a dropdown menu with all of the available options of properties and methods. Another tool is to use the `Bookmarks` to save the location of a particular code so you can reference it later if need be.

<br>

#### View Menu <a name="view"></a>
View menu has the some useful tools other than adding different menu items to your toolbar. `Last Position` will move the cursor back to it previous location. `Definition` opens up a window with a list of all the properties/methods along with a description on each. `Object Browser` is similar to definition but displays a list of all the objects.

The `Immediate` button will open up a window where you can change temporary change your code; such as, change a variable's data. Also in the `Immediate` window you can write `debug.Print varName` to display the result.

The `Locals` window will display information about all of the local variables in the current modules. The `Watch Window` allows you to select a variable to shadow and displays its changes throughout the code (good for debugging). It will also display vast amount of information that can be toggling the `+` symbol next to it.

<br>

#### Debug Menu <a name="dbug"></a>
The `Debug` menu is really important as it will help you find and fix errors in your code. `Step Into` when run goes into any methods and runs the code line by line. If you wanted to get out of a method `Step Out` will get you out of any methods/subs. `Run to Cursor` will run the code from beginning to where your cursor is.

In addition is you can also add, edit, remove watches. `Toggle Breakpoint` will run the code up to the breakpoint then wait for you to resume the code until the next breakpoint or end. `Set Next Statement` will allow you to temporary skip code and jump to the marker (yellow arrow) and start running code from that line.

<br>

### Logic <a name="logic"></a>
#### Last Row <a name="lastrow"></a>
To find the last row of the data set in your workbook combine these methods and it will return the last row value as an integer ex: `lastRow = Cells(Rows.Count, 1).End(xlup).Row`. What this does is it goes through all the rows in column one. Then it goes up until it finds the first cell with a value in it.

<figure>
  <img src="/img/posts/excel-vba/lastrow.jpg" class="blg-img" alt="Find the last row with data">
  <figcaption>This method helps find the last row with data</figcaption>
</figure>

<br>

#### Last Column <a name="lastcolumn"></a>
To find the last column of the data set in your workbook cmbine these methods and it will return the last column value as an integer ex: `lastColumn = Cells(1, Columns.Count).End(xlToLeft).Column`. What this does is it goes to to the last column then back left to the first cell with a value in it.

<figure>
  <img src="/img/posts/excel-vba/lastcol.jpg" class="blg-img" alt="Find the last column with data">
  <figcaption>This method helps find the last column with data</figcaption>
</figure>

<br>

#### Next Row <a name="nextrow"></a>
To get the next row you simply use the formula for the last row and add 1 to it ex: `lastRow = Cells(Rows.Count, 1).End(xlup).Row + 1`

<br>

#### Record Macro <a name="macro"></a>
Excel give you the ability to record a macro while you perform the function on the physical workbook. It then creates a module with the code written. See sample below on steps to recording a macro.

<figure>
  <img src="/img/posts/excel-vba/macro1.jpg" class="blg-img" alt="Hit record">
  <figcaption>Step 1: Hit record macro on dev tab</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/macro2.jpg" class="blg-img" alt="Enter macros name and other info">
  <figcaption>Step 2: Enter macros name and other info</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/macro3.jpg" class="blg-img" alt="Work on your workbook">
  <figcaption>Step 3: Work on your workbook until finished</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/macro4.jpg" class="blg-img" alt="Stop recording">
  <figcaption>Step 4: Stop recording</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/macro5.jpg" class="blg-img" alt="Your code will be in modules">
  <figcaption>Step 5: You can review and edit your code</figcaption>
</figure>

<br>

#### Absolute vs Relative Reference <a name="abrelref"></a>
Absolute reference is when objects are referring to a specific cell, which is hard coded. When the macro is run it will always reference to that specific cell. Relative reference dynamically changes the location of the cell by using the current position of the cursor as the starting point. To use relative reference make sure to check the `Use Relative References` button.

<figure>
  <img src="/img/posts/excel-vba/abrelref.jpg" class="blg-img" alt="Absolute vs relative reference">
  <figcaption>Absolute on top and Relative on bottom</figcaption>
</figure>

<br>
