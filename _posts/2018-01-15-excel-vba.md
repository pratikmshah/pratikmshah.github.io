---
title:  "Excel VBA Reference"
date:   2018-01-15
image: "/excel-vba/excel.png"
---
Excel's VBA function allows the user to enhance a workbook by allowing them to automate and manipulate elements and tasks into the excel workbook. Excel uses the programing language visual basic which is an event-driven programming language that is user friendly and specifically for beginners. I remember when I first used VBA to automate formatting of data, with a push of the button I saved 15 minutes every day.

<br>

### Table of Contents
 1. [Developer](#dev)
 - [Developer Tab](#devtab)
 2. [Range](#range)
 - [Range Object](#rangeobj)
 - [Creating a Macro](#firstmacro)
 - [Debugging](#debug)
 - [Saving Macro](#save)
 - [Executing Macro](#trigger)
 - [Multiple Cells One Range](#multirange)
 - [Named Range](#namerange)
 3. [Range Properties](#rangeprop)
 - [Value](#valueprop)
 - [Text](#textprop)
 - [Row & Column](#rowcol)
 - [Select](#select)
 - [Count](#count)
 - [Address](#address)
 - [Formula](#formula)
 - [Number Formatter](#numformat)
 - [Font Bold, Underline, Italic](#font)
 4. [Cells](#cell)
 - [Cells Object](#cellobj)


 <br>

### Developer <a name="dev"></a>
#### Developer Tab <a name="devtab"></a>
To enable the developer tab go to `File` --> `Options` --> `Customize Ribbon` --> check `Developer` box --> `OK`.

<figure>
  <img src="/img/posts/excel-vba/dev_tab.jpg" class="blg-img" alt="Dev Tab">
  <figcaption>Enable the developer tab</figcaption>
</figure>

<br>

### Range <a name="range"></a>
#### Range Object <a name="rangeobj"></a>
The range object is the rows and columns of the element(s). For instance, if I have highlighted the first cell it would be a range of `A1`. If I highlighted the first three columns and first three rows it would be a range of `A1:C3`. For multiple columns you just take the first element `:` then the last element in range.

<figure>
  <img src="/img/posts/excel-vba/rangeobj.jpg" class="blg-img" alt="Sample Range Object">
  <figcaption>Range of B2:E6</figcaption>
</figure>

<br>

#### Creating a Macro<a name="firstmacro"></a>
To open up the VBA developer IDE(Integrated Development Environment) use the shortcut key `alt`+`F11`. Alternatively you can go to the `Developer` tab and click on `Visual Basic`.

To write your code you need to create `modules`. Click on the icon `Insert Modules`, they look like skittles, then `Module`. You can have as many modules as you like.

<figure>
  <img src="/img/posts/excel-vba/add_module.jpg" class="blg-img" alt="Add module">
  <figcaption>Adding a module</figcaption>
</figure>

Your macro code will go in between `Sub MacroName()` and `End Sub` keywords. To specify a value to a specific cell use the `Range("rowcolumn") = value`.  To run the macro click play button (green triangle). You can also specify multiple cell ranges using the `:`. You can set value to strings using the `""` ex: `Range("a1") = "Hello World!"`

<figure>
  <img src="/img/posts/excel-vba/hello.jpg" class="blg-img" alt="First Macro">
  <figcaption>Coding and running macro</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/number.jpg" class="blg-img" alt="Multiple Cells">
  <figcaption>Multiple ranges</figcaption>
</figure>

You can stack multiple commands one right after each other. The compiler will read the code from top down.

<figure>
  <img src="/img/posts/excel-vba/multicommands.jpg" class="blg-img" alt="Multiple Commands">
  <figcaption>Multiple commands</figcaption>
</figure>

<br>

#### Debugging <a name="debug"></a>
You can debug each line of code in excel by using the `F8` key and watching one by one what happens to the workbook. As your code gets longer there maybe some logic error in your code that needs to be fixed; using the debugger tool will help assist you.

<figure>
  <img src="/img/posts/excel-vba/debug.jpg" class="blg-img" alt="Debugger">
  <figcaption>Debugger</figcaption>
</figure>

<br>

#### Saving Macro <a name="save"></a>
In order to save a macro workbook it needs to be saved with the `xlsm` file extension or else it will not work. So when saving the first time the save as type should be `Excel Macro-Enabled Workbook`.

<br>

#### Executing Macros <a name="trigger"></a>
- `alt` + `F11` and then click `play` then `run`
- on developer tab click `Macros` icon and then `select` macro and `run` (shortcut `alt` + `F8`)

There are more sophisticated ways such as clicking on a button or a specific cell etc..

<br>

#### Multiple Cells One Range <a name="multirange"></a>
You can set values to multiple cells in one range command ex: `Range("a1:c4, e3") = 15`.

<figure>
  <img src="/img/posts/excel-vba/multirange.jpg" class="blg-img" alt="Multiple Cells From One Range Command">
  <figcaption>Multiple cell values from one range commmand</figcaption>
</figure>

<br>

#### Named Range <a name="namerange"></a>
Instead of specifying specific rows and columns in a macro you can set the range to reference a named ranged.

<figure>
  <img src="/img/posts/excel-vba/tax_table.jpg" class="blg-img" alt="Named Range">
  <figcaption>Set a named range</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/named_range.jpg" class="blg-img" alt="Reference Named Range">
  <figcaption>Reference a named range</figcaption>
</figure>

<br>

### Range Properties <a name="rangeprop"></a>
#### Value <a name="valueprop"></a>
To access properties you use the `.` operator and a list of properties available should pop up. The value property gets the value for the range.

<figure>
  <img src="/img/posts/excel-vba/value.jpg" class="blg-img" alt="Value Property">
  <figcaption>Value property</figcaption>
</figure>

<br>

#### Text <a name="textprop"></a>
The text property gets the data as a string. If you don't specify a property the default is the value property.

<figure>
  <img src="/img/posts/excel-vba/text.jpg" class="blg-img" alt="Text Property">
  <figcaption>Text property</figcaption>
</figure>

<br>

#### Row and Column <a name="rowcol"></a>
The row and column property will return the row number and column number back in integer of the range.

<figure>
  <img src="/img/posts/excel-vba/row.jpg" class="blg-img" alt="Row Property">
  <figcaption>Row property</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/column.jpg" class="blg-img" alt="Column Property">
  <figcaption>Column property</figcaption>
</figure>

<br>

#### Select <a name="select"></a>
The select property sets the cursor location to the referenced name.

<figure>
  <img src="/img/posts/excel-vba/select.jpg" class="blg-img" alt="Select Property">
  <figcaption>Select property</figcaption>
</figure>

<br>

#### Count <a name="count"></a>
The count property counts how many cells are in the referenced range. Note it does not matter if their is data in the cell or not.

<figure>
  <img src="/img/posts/excel-vba/count.jpg" class="blg-img" alt="Count Property">
  <figcaption>Count property</figcaption>
</figure>

<br>

#### Address <a name="address"></a>
The address property of a range returns the location of the row and column as in excel ex: `A5`. You can specify if you want absolute paths of the row/column by specifying a 1 or 0; absolute includes the `$` sign.

<figure>
  <img src="/img/posts/excel-vba/address.jpg" class="blg-img" alt="Address Property">
  <figcaption>Address property</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/address2.jpg" class="blg-img" alt="Address Property No Absolute">
  <figcaption>Address property without absolute</figcaption>
</figure>

<br>

#### Formula <a name="formula"></a>
The formula property allows you to set a formula to a specific cell.

<figure>
  <img src="/img/posts/excel-vba/formula.jpg" class="blg-img" alt="Formula Property">
  <figcaption>Formula property</figcaption>
</figure>

<br>

#### Number Format <a name="numformat"></a>
The number format changes the format of the value from general to currency, accounting, date, time etc...

<figure>
  <img src="/img/posts/excel-vba/format.jpg" class="blg-img" alt="Number Formatter Property">
  <figcaption>Number formatter property</figcaption>
</figure>

<br>

#### Font Bold, Underline, Italic <a name="font"></a>
The font property you can change the style of the font but it takes a boolean (true/false) value.

<figure>
  <img src="/img/posts/excel-vba/font.jpg" class="blg-img" alt="Font Style Property">
  <figcaption>Number formatter property</figcaption>
</figure>

<br>

### Cells <a name="cell"></a>
#### Cells Object <a name="cellsobj"></a>
The cells object is similar to the range object but instead of a range you put in the cell coordinates as integers (row, column). This is great for looping through entire rows or columns.

<figure>
  <img src="/img/posts/excel-vba/cells.jpg" class="blg-img" alt="Cells Object">
  <figcaption>Cells object</figcaption>
</figure>

<br>
