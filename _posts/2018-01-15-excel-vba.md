---
title:  "Excel VBA Reference"
date:   2018-01-15
image: "/excel-vba/excel.png"
---
Excel's VBA function allows the user to enhance a workbook by allowing them to automate and manipulate elements and tasks into the excel workbook. Excel uses the programing language visual basic which is an event-driven programming language that is user friendly and specifically for beginners. I remember when I first used VBA to automate formatting of data, with a push of the button I saved 15 minutes every day.

<br>

### Table of Contents
 1. [Developer](#dev)
 - [Developer Tab](#devtab)
 2. [Range](#range)
 - [Range Object](#rangeobj)
 - [Creating a Macro](#firstmacro)
 - [Debugging](#debug)
 - [Saving Macro](#save)
 - [Executing Macro](#trigger)
 - [Multiple Cells One Range](#multirange)
 - [Named Range](#namerange)


 <br>

### Developer <a name="dev"></a>
#### Developer Tab <a name="devtab"></a>
To enable the developer tab go to `File` --> `Options` --> `Customize Ribbon` --> check `Developer` box --> `OK`.

<figure>
  <img src="/img/posts/excel-vba/dev_tab.jpg" class="blg-img" alt="Dev Tab">
  <figcaption>Enable the developer tab</figcaption>
</figure>

<br>

### Range <a name="range"></a>
#### Range Object <a name="rangeobj"></a>
The range object is the rows and columns of the element(s). For instance, if I have highlighted the first cell it would be a range of `A1`. If I highlighted the first three columns and first three rows it would be a range of `A1:C3`. For multiple columns you just take the first element `:` then the last element in range.

<figure>
  <img src="/img/posts/excel-vba/rangeobj.jpg" class="blg-img" alt="Sample Range Object">
  <figcaption>Range of B2:E6</figcaption>
</figure>

<br>

#### Creating a Macro<a name="firstmacro"></a>
To open up the VBA developer IDE(Integrated Development Environment) use the shortcut key `alt`+`F11`. Alternatively you can go to the `Developer` tab and click on `Visual Basic`.

To write your code you need to create `modules`. Click on the icon `Insert Modules`, they look like skittles, then `Module`. You can have as many modules as you like.

<figure>
  <img src="/img/posts/excel-vba/add_module.jpg" class="blg-img" alt="Add module">
  <figcaption>Adding a module</figcaption>
</figure>

Your macro code will go in between `Sub MacroName()` and `End Sub` keywords. To specify a value to a specific cell use the `Range("rowcolumn") = value`.  To run the macro click play button (green triangle). You can also specify multiple cell ranges using the `:`. You can set value to strings using the `""` ex: `Range("a1") = "Hello World!"`

<figure>
  <img src="/img/posts/excel-vba/hello.jpg" class="blg-img" alt="First Macro">
  <figcaption>Coding and running macro</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/number.jpg" class="blg-img" alt="Multiple Cells">
  <figcaption>Multiple ranges</figcaption>
</figure>

You can stack multiple commands one right after each other. The compiler will read the code from top down.

<figure>
  <img src="/img/posts/excel-vba/multicommands.jpg" class="blg-img" alt="Multiple Commands">
  <figcaption>Multiple commands</figcaption>
</figure>

<br>

#### Debugging <a name="debug"></a>
You can debug each line of code in excel by using the `F8` key and watching one by one what happens to the workbook. As your code gets longer there maybe some logic error in your code that needs to be fixed; using the debugger tool will help assist you.

<figure>
  <img src="/img/posts/excel-vba/debug.jpg" class="blg-img" alt="Debugger">
  <figcaption>Debugger</figcaption>
</figure>

<br>

#### Saving Macro <a name="save"></a>
In order to save a macro workbook it needs to be saved with the `xlsm` file extension or else it will not work. So when saving the first time the save as type should be `Excel Macro-Enabled Workbook`.

<br>

#### Executing Macros <a name="trigger"></a>
- `alt` + `F11` and then click `play` then `run`
- on developer tab click `Macros` icon and then `select` macro and `run` (shortcut `alt` + `F8`)

There are more sophisticated ways such as clicking on a button or a specific cell etc..

<br>

#### Multiple Cells One Range <a name="multirange"></a>
You can set values to multiple cells in one range command ex: `Range("a1:c4, e3") = 15`.

<figure>
  <img src="/img/posts/excel-vba/multirange.jpg" class="blg-img" alt="Multiple Cells From One Range Command">
  <figcaption>Multiple cell values from one range commmand</figcaption>
</figure>

<br>

#### Named Range <a name="namerange"></a>
Instead of specifying specific rows and columns in a macro you can set the range to reference a named ranged.

<figure>
  <img src="/img/posts/excel-vba/tax_table.jpg" class="blg-img" alt="Named Range">
  <figcaption>Set a named range</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/named_range.jpg" class="blg-img" alt="Reference Named Range">
  <figcaption>Reference a named range</figcaption>
</figure>

<br>
