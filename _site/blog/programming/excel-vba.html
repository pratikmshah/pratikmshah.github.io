<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="description" content="Programming tutorials tips and tricks">
  <meta name="keywords" content="HTML, CSS, JavaScript, Ruby, Jekyll, Sass, Rails, AngularJS, React">
  <meta name="author" content="Pratik Shah">

  <title>Excel VBA Reference</title>
  <meta name="description" content="Excel’s VBA function allows the user to enhance a workbook by allowing them to automate and manipulate elements and tasks into the excel workbook. Excel uses...">

  <link rel="icon" href="/favicon.ico?v=2" type="image/x-icon" />
  <link rel="stylesheet" href="/css/devicon.min.css">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://localhost:4000/blog/programming/excel-vba">
  <link rel="alternate" type="application/rss+xml" title="pratik." href="http://localhost:4000/feed.xml">


  <script type="text/javascript" src="/js/jquery-2.2.0.min.js"></script>
  <script type="text/javascript" src="/js/analytics.js"></script>
  <script type="text/javascript" src="/js/bootstrap.min.js"></script>
  <script src="https://npmcdn.com/imagesloaded@4.1/imagesloaded.pkgd.min.js"></script>
  <script type="text/javascript" src="/js/masonry.pkgd.min.js"></script>
  <script type="text/javascript" src="/js/homepage.js"></script>
  <script type="text/javascript" src="/js/project.js"></script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <ul class="trigger list-unstyled list-inline">
        <li class="cust-page-lnks">
          <a class="page-link nav-link" href="/"><span class="font-title">Home</span></a>
        </li>
        
          
            <li class="cust-page-lnks">
              <a class="page-link nav-link" href="/about/"><span class="font-title">About</span></a>
            </li>
          
        
          
            <li class="cust-page-lnks">
              <a class="page-link nav-link" href="/blog/"><span class="font-title">Blog</span></a>
            </li>
          
        
          
        
          
        
          
            <li class="cust-page-lnks">
              <a class="page-link nav-link" href="/projects/"><span class="font-title">Projects</span></a>
            </li>
          
        
      </ul>

    </nav>
  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article id="post" class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <p class="post-meta"><time datetime="2018-01-15T00:00:00-06:00" itemprop="datePublished">Jan 15, 2018</time></p>
    <h1 id="post-title" class="post-title" itemprop="name headline">Excel VBA Reference</h1>
  </header>

  
  <div>
    <img src="/img/posts/excel-vba/excel.png">
  </div>
  

  <div class="post-content" itemprop="articleBody">
    <p>Excel’s VBA function allows the user to enhance a workbook by allowing them to automate and manipulate elements and tasks into the excel workbook. Excel uses the programing language visual basic which is an event-driven programming language that is user friendly and specifically for beginners. I remember when I first used VBA to automate formatting of data, with a push of the button I saved 15 minutes every day.</p>

<p><br /></p>

<h3 id="table-of-contents">Table of Contents</h3>
<ol>
  <li><a href="#dev">Developer</a>
    <ul>
      <li><a href="#devtab">Developer Tab</a></li>
    </ul>
  </li>
  <li><a href="#range">Range</a>
    <ul>
      <li><a href="#rangeobj">Range Object</a></li>
      <li><a href="#firstmacro">Creating a Macro</a></li>
      <li><a href="#debug">Debugging</a></li>
      <li><a href="#save">Saving Macro</a></li>
      <li><a href="#trigger">Executing Macro</a></li>
      <li><a href="#multirange">Multiple Cells One Range</a></li>
      <li><a href="#namerange">Named Range</a></li>
    </ul>
  </li>
  <li><a href="#rangeprop">Range Properties</a>
    <ul>
      <li><a href="#valueprop">Value</a></li>
      <li><a href="#textprop">Text</a></li>
      <li><a href="#rowcol">Row &amp; Column</a></li>
      <li><a href="#select">Select</a></li>
      <li><a href="#count">Count</a></li>
      <li><a href="#address">Address</a></li>
      <li><a href="#formula">Formula</a></li>
      <li><a href="#numformat">Number Formatter</a></li>
      <li><a href="#font">Font Bold, Underline, Italic</a></li>
    </ul>
  </li>
  <li><a href="#cell">Cells</a>
    <ul>
      <li><a href="#cellobj">Cells Object</a></li>
      <li><a href="#poscell">Cells Position</a></li>
      <li><a href="#cellall">Select All Cells</a></li>
      <li><a href="#rangecell">Range with Cells</a></li>
    </ul>
  </li>
  <li><a href="#variable">Variables</a>
    <ul>
      <li><a href="#vartypes">Variable Types</a></li>
      <li><a href="#decvar">Declaring Variable</a></li>
      <li><a href="#callpro">Calling A Procedure</a></li>
      <li><a href="#pubpriv">Public/Private</a></li>
      <li><a href="#constants">Constants</a></li>
      <li><a href="#concat">Concatenate Strings</a></li>
      <li><a href="#valref">Pass By Value/Reference</a></li>
    </ul>
  </li>
  <li><a href="#toolmenu">Editor Toolbars and Menus</a>
    <ul>
      <li><a href="#file">File Menu</a></li>
      <li><a href="#edit">Edit Menu</a></li>
      <li><a href="#view">View Menu</a></li>
      <li><a href="#dbug">Debug Menu</a></li>
    </ul>
  </li>
  <li><a href="#logic">VBA Logic</a>
    <ul>
      <li><a href="#lastrow">Find Last Row</a></li>
      <li><a href="#lastcolumn">Find Last Column</a></li>
      <li><a href="#nextrow">Find Next Row</a></li>
      <li><a href="#macro">Record Macro</a></li>
      <li><a href="#abrelref">Absolute vs Relative Reference</a></li>
      <li><a href="#endwith">With and End</a></li>
      <li><a href="#compare">Comparison Operators</a></li>
      <li><a href="#ifthen">If Then</a></li>
      <li><a href="#isnot">Is Not Equal To &amp; Not</a></li>
      <li><a href="#else">Else</a></li>
      <li><a href="#elseif">Else If</a></li>
      <li><a href="#comptxtnum">Comparative Operators Text &amp; Numbers</a></li>
      <li><a href="#golabel">Goto &amp; Label</a></li>
      <li><a href="#selcase">Select Case</a></li>
      <li><a href="#msgbox">Message Box Options</a></li>
      <li><a href="#relpos">Relative Positioning</a></li>
    </ul>
  </li>
  <li><a href="#loop">Loops &amp; Reports</a>
    <ul>
      <li><a href="#forl">For Loop</a></li>
      <li><a href="#report">Simple Report</a></li>
      <li><a href="#input">Input Box</a></li>
      <li><a href="#button">Button</a></li>
      <li><a href="#reportprint">Reporting</a></li>
      <li><a href="#printing">Printing</a></li>
      <li><a href="#reverseloop">Reverse For Loop</a></li>
      <li><a href="#foreach">For Each Loop</a></li>
      <li><a href="#doloop">Do Loop</a></li>
      <li><a href="#dountil">Do Until</a></li>
      <li><a href="#loopuntil">Loop Until</a></li>
      <li><a href="#dowhile">Do While</a></li>
      <li><a href="#loopwhile">Loop While</a></li>
      <li><a href="#exitdo">Exit Loops</a></li>
    </ul>
  </li>
  <li><a href="#events">Events</a>
    <ul>
      <li><a href="#introevent">Intro Events &amp; Selection Change</a></li>
      <li><a href="#activate">Activate</a></li>
      <li><a href="#deactivate">Deactivate</a></li>
      <li><a href="#beforedel">Before Delete</a></li>
      <li><a href="#beforedouble">Before Double Click</a></li>
      <li><a href="#beforerightclk">Before Right Click</a></li>
      <li><a href="#calculate">Calculates Event</a></li>
      <li><a href="#disableevent">Disable Events</a></li>
      <li><a href="#changeevent">Change Event</a></li>
      <li><a href="#links">Hyperlinks</a></li>
    </ul>
  </li>
  <li><a href="#wrkbookevent">Workbook Events</a>
    <ul>
      <li><a href="#wrkbookopen">Workbook Open</a></li>
      <li><a href="#wrkbookactivate">Workbook Activate</a></li>
      <li><a href="#beforesave">Before Save</a></li>
      <li><a href="#aftersave">After Save</a></li>
      <li><a href="#beforeclose">Before Close</a></li>
      <li><a href="#beforeprint">Before Print</a></li>
      <li><a href="#workbookdeactivate">Workbook Deactivate</a></li>
      <li><a href="#newchart">New Chart</a></li>
      <li><a href="#newsheet">New Sheet</a></li>
      <li><a href="#sheetactive">Sheet Activate</a></li>
      <li><a href="#sheetbeforedelete">Sheet Before Delete</a></li>
      <li><a href="#sheetdoubleclick">Sheet Before Double Click</a></li>
      <li><a href="#sheetrightclick">Sheet Before Right Click</a></li>
      <li><a href="#sheetcalculation">Sheet Calculation</a></li>
      <li><a href="#sheetchange">Sheet Change</a></li>
      <li><a href="#sheetdeactivate">Sheet Deactivate</a></li>
      <li><a href="#sheetselectionchange">Sheet Selection Change</a></li>
      <li><a href="#windowactivate">Window Activate</a></li>
      <li><a href="#windowdeactivate">Window Deactivate</a></li>
      <li><a href="#windowresize">Window Resize</a></li>
    </ul>
  </li>
  <li><a href="#activex">Active X Controls</a>
    <ul>
      <li><a href="#activevsform">Form Buttons</a></li>
      <li><a href="#keydown">Key Down &amp; Press</a></li>
      <li><a href="#mouse">Mouse Move</a></li>
      <li><a href="#mouseupdown">Mouse Up/Down &amp; Left Middle Right Click</a></li>
      <li><a href="#focus">GotFocus &amp; LostFocus</a></li>
      <li><a href="#checkbox">Checkbox</a></li>
      <li><a href="#linkcell">Link Cell</a></li>
      <li><a href="#optionbutton">Option Buttons</a></li>
      <li><a href="#spinbutton">Spin Button &amp; Textbox</a></li>
      <li><a href="#labels1">Labels</a></li>
      <li><a href="#combo">ComboBox Fill with List Fill Range</a></li>
      <li><a href="#listbox">List Box</a></li>
      <li><a href="#scroll">Scroll Bar</a></li>
      <li><a href="#image">Image Control</a></li>
      <li><a href="#toggle">Toggle Button</a></li>
    </ul>
  </li>
  <li><a href="#userforms">User Forms</a>
    <ul>
      <li><a href="#hideshow">Hide Show &amp; Unload</a></li>
      <li><a href="#status">Status Box</a></li>
      <li><a href="#newdata">New Data</a></li>
      <li><a href="#txt2num">Convert to Numbers</a></li>
      <li><a href="#taborder">Tab Order</a></li>
      <li><a href="#defval">Default Value</a></li>
      <li><a href="#duplicate">Prevent Duplicate</a></li>
      <li><a href="#editmode">Edit Mode</a></li>
      <li><a href="#reportfilter">Report w Filters</a></li>
    </ul>
  </li>
</ol>

<p><br /></p>

<h3 id="developer-">Developer <a name="dev"></a></h3>
<h4 id="developer-tab-">Developer Tab <a name="devtab"></a></h4>
<p>To enable the developer tab go to <code class="highlighter-rouge">File</code> –&gt; <code class="highlighter-rouge">Options</code> –&gt; <code class="highlighter-rouge">Customize Ribbon</code> –&gt; check <code class="highlighter-rouge">Developer</code> box –&gt; <code class="highlighter-rouge">OK</code>.</p>

<figure>
  <img src="/img/posts/excel-vba/dev_tab.jpg" class="blg-img" alt="Dev Tab" />
  <figcaption>Enable the developer tab</figcaption>
</figure>

<p><br /></p>

<h3 id="range-">Range <a name="range"></a></h3>
<h4 id="range-object-">Range Object <a name="rangeobj"></a></h4>
<p>The range object is the rows and columns of the element(s). For instance, if I have highlighted the first cell it would be a range of <code class="highlighter-rouge">A1</code>. If I highlighted the first three columns and first three rows it would be a range of <code class="highlighter-rouge">A1:C3</code>. For multiple columns you just take the first element <code class="highlighter-rouge">:</code> then the last element in range.</p>

<figure>
  <img src="/img/posts/excel-vba/rangeobj.jpg" class="blg-img" alt="Sample Range Object" />
  <figcaption>Range of B2:E6</figcaption>
</figure>

<p><br /></p>

<h4 id="creating-a-macro">Creating a Macro<a name="firstmacro"></a></h4>
<p>To open up the VBA developer IDE(Integrated Development Environment) use the shortcut key <code class="highlighter-rouge">alt</code>+<code class="highlighter-rouge">F11</code>. Alternatively you can go to the <code class="highlighter-rouge">Developer</code> tab and click on <code class="highlighter-rouge">Visual Basic</code>.</p>

<p>To write your code you need to create <code class="highlighter-rouge">modules</code>. Click on the icon <code class="highlighter-rouge">Insert Modules</code>, they look like skittles, then <code class="highlighter-rouge">Module</code>. You can have as many modules as you like.</p>

<figure>
  <img src="/img/posts/excel-vba/add_module.jpg" class="blg-img" alt="Add module" />
  <figcaption>Adding a module</figcaption>
</figure>

<p>Your macro code will go in between <code class="highlighter-rouge">Sub MacroName()</code> and <code class="highlighter-rouge">End Sub</code> keywords. To specify a value to a specific cell use the <code class="highlighter-rouge">Range("rowcolumn") = value</code>.  To run the macro click play button (green triangle). You can also specify multiple cell ranges using the <code class="highlighter-rouge">:</code>. You can set value to strings using the <code class="highlighter-rouge">""</code> ex: <code class="highlighter-rouge">Range("a1") = "Hello World!"</code></p>

<figure>
  <img src="/img/posts/excel-vba/hello.jpg" class="blg-img" alt="First Macro" />
  <figcaption>Coding and running macro</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/number.jpg" class="blg-img" alt="Multiple Cells" />
  <figcaption>Multiple ranges</figcaption>
</figure>

<p>You can stack multiple commands one right after each other. The compiler will read the code from top down.</p>

<figure>
  <img src="/img/posts/excel-vba/multicommands.jpg" class="blg-img" alt="Multiple Commands" />
  <figcaption>Multiple commands</figcaption>
</figure>

<p><br /></p>

<h4 id="debugging-">Debugging <a name="debug"></a></h4>
<p>You can debug each line of code in excel by using the <code class="highlighter-rouge">F8</code> key and watching one by one what happens to the workbook. As your code gets longer there maybe some logic error in your code that needs to be fixed; using the debugger tool will help assist you.</p>

<figure>
  <img src="/img/posts/excel-vba/debug.jpg" class="blg-img" alt="Debugger" />
  <figcaption>Debugger</figcaption>
</figure>

<p><br /></p>

<h4 id="saving-macro-">Saving Macro <a name="save"></a></h4>
<p>In order to save a macro workbook it needs to be saved with the <code class="highlighter-rouge">xlsm</code> file extension or else it will not work. So when saving the first time the save as type should be <code class="highlighter-rouge">Excel Macro-Enabled Workbook</code>.</p>

<p><br /></p>

<h4 id="executing-macros-">Executing Macros <a name="trigger"></a></h4>
<ul>
  <li><code class="highlighter-rouge">alt</code> + <code class="highlighter-rouge">F11</code> and then click <code class="highlighter-rouge">play</code> then <code class="highlighter-rouge">run</code></li>
  <li>on developer tab click <code class="highlighter-rouge">Macros</code> icon and then <code class="highlighter-rouge">select</code> macro and <code class="highlighter-rouge">run</code> (shortcut <code class="highlighter-rouge">alt</code> + <code class="highlighter-rouge">F8</code>)</li>
</ul>

<p>There are more sophisticated ways such as clicking on a button or a specific cell etc..</p>

<p><br /></p>

<h4 id="multiple-cells-one-range-">Multiple Cells One Range <a name="multirange"></a></h4>
<p>You can set values to multiple cells in one range command ex: <code class="highlighter-rouge">Range("a1:c4, e3") = 15</code>.</p>

<figure>
  <img src="/img/posts/excel-vba/multirange.jpg" class="blg-img" alt="Multiple Cells From One Range Command" />
  <figcaption>Multiple cell values from one range commmand</figcaption>
</figure>

<p><br /></p>

<h4 id="named-range-">Named Range <a name="namerange"></a></h4>
<p>Instead of specifying specific rows and columns in a macro you can set the range to reference a named ranged.</p>

<figure>
  <img src="/img/posts/excel-vba/tax_table.jpg" class="blg-img" alt="Named Range" />
  <figcaption>Set a named range</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/named_range.jpg" class="blg-img" alt="Reference Named Range" />
  <figcaption>Reference a named range</figcaption>
</figure>

<p><br /></p>

<h3 id="range-properties-">Range Properties <a name="rangeprop"></a></h3>
<h4 id="value-">Value <a name="valueprop"></a></h4>
<p>To access properties you use the <code class="highlighter-rouge">.</code> operator and a list of properties available should pop up. The value property gets the value for the range.</p>

<figure>
  <img src="/img/posts/excel-vba/value.jpg" class="blg-img" alt="Value Property" />
  <figcaption>Value property</figcaption>
</figure>

<p><br /></p>

<h4 id="text-">Text <a name="textprop"></a></h4>
<p>The text property gets the data as a string. If you don’t specify a property the default is the value property.</p>

<figure>
  <img src="/img/posts/excel-vba/text.jpg" class="blg-img" alt="Text Property" />
  <figcaption>Text property</figcaption>
</figure>

<p><br /></p>

<h4 id="row-and-column-">Row and Column <a name="rowcol"></a></h4>
<p>The row and column property will return the row number and column number back in integer of the range.</p>

<figure>
  <img src="/img/posts/excel-vba/row.jpg" class="blg-img" alt="Row Property" />
  <figcaption>Row property</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/column.jpg" class="blg-img" alt="Column Property" />
  <figcaption>Column property</figcaption>
</figure>

<p><br /></p>

<h4 id="select-">Select <a name="select"></a></h4>
<p>The select property sets the cursor location to the referenced name.</p>

<figure>
  <img src="/img/posts/excel-vba/select.jpg" class="blg-img" alt="Select Property" />
  <figcaption>Select property</figcaption>
</figure>

<p><br /></p>

<h4 id="count-">Count <a name="count"></a></h4>
<p>The count property counts how many cells are in the referenced range. Note it does not matter if their is data in the cell or not.</p>

<figure>
  <img src="/img/posts/excel-vba/count.jpg" class="blg-img" alt="Count Property" />
  <figcaption>Count property</figcaption>
</figure>

<p><br /></p>

<h4 id="address-">Address <a name="address"></a></h4>
<p>The address property of a range returns the location of the row and column as in excel ex: <code class="highlighter-rouge">A5</code>. You can specify if you want absolute paths of the row/column by specifying a 1 or 0; absolute includes the <code class="highlighter-rouge">$</code> sign.</p>

<figure>
  <img src="/img/posts/excel-vba/address.jpg" class="blg-img" alt="Address Property" />
  <figcaption>Address property</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/address2.jpg" class="blg-img" alt="Address Property No Absolute" />
  <figcaption>Address property without absolute</figcaption>
</figure>

<p><br /></p>

<h4 id="formula-">Formula <a name="formula"></a></h4>
<p>The formula property allows you to set a formula to a specific cell.</p>

<figure>
  <img src="/img/posts/excel-vba/formula.jpg" class="blg-img" alt="Formula Property" />
  <figcaption>Formula property</figcaption>
</figure>

<p><br /></p>

<h4 id="number-format-">Number Format <a name="numformat"></a></h4>
<p>The number format changes the format of the value from general to currency, accounting, date, time etc…</p>

<figure>
  <img src="/img/posts/excel-vba/format.jpg" class="blg-img" alt="Number Formatter Property" />
  <figcaption>Number formatter property</figcaption>
</figure>

<p><br /></p>

<h4 id="font-bold-underline-italic-name-size-">Font Bold, Underline, Italic, Name, Size <a name="font"></a></h4>
<p>The font property you can change the style of the font but it takes a boolean (true/false) value. You can also use <code class="highlighter-rouge">Font.Name = "Font Name"</code> to change the font type. Also change the size by using <code class="highlighter-rouge">Font.Size = 12</code>.</p>

<figure>
  <img src="/img/posts/excel-vba/font.jpg" class="blg-img" alt="Font Style Property" />
  <figcaption>Number formatter property</figcaption>
</figure>

<p><br /></p>

<h3 id="cells-">Cells <a name="cell"></a></h3>
<h4 id="cells-object-">Cells Object <a name="cellobj"></a></h4>
<p>The cells object is similar to the range object but instead of a range you put in the cell coordinates as integers (row, column). This is great for looping through entire rows or columns. You can substitute the column numbers for letters but need to put them in <code class="highlighter-rouge">""</code></p>

<figure>
  <img src="/img/posts/excel-vba/cells.jpg" class="blg-img" alt="Cells Object" />
  <figcaption>Cells object</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/cells2.jpg" class="blg-img" alt="Cells Object" />
  <figcaption>Cells object with letter column</figcaption>
</figure>

<p><br /></p>

<h4 id="cell-position-">Cell Position <a name="poscell"></a></h4>
<p>You can reference the cell’s position by specifying the integer location. It starts with the row A1 = 1, B1 = 2, C1 = 3 etc. However, if you select a range and then use the <code class="highlighter-rouge">.</code> operator and use cell object it will only count within the referenced range.</p>

<figure>
  <img src="/img/posts/excel-vba/poscell.jpg" class="blg-img" alt="Cell Position" />
  <figcaption>Cell Position</figcaption>
</figure>

<p><br /></p>

<h4 id="select-all-cells-">Select All Cells <a name="cellall"></a></h4>
<p>You can select every cell in the workbook by simply not referencing a specific cell; <code class="highlighter-rouge">Cells</code>.</p>

<figure>
  <img src="/img/posts/excel-vba/cellall.jpg" class="blg-img" alt="Cell Position" />
  <figcaption>Select all cells</figcaption>
</figure>

<p><br /></p>

<h4 id="range-object-with-cell-">Range Object With Cell <a name="rangecell"></a></h4>
<p>Sometimes you will want to select from a specific cell to cell without hardcoding the range. You can do this by using <code class="highlighter-rouge">Cell(r,c)</code> as a parameter for the <code class="highlighter-rouge">Range()</code> object.</p>

<figure>
  <img src="/img/posts/excel-vba/rangecell.jpg" class="blg-img" alt="Range object with cell" />
  <figcaption>Using range object with the cell</figcaption>
</figure>

<p><br /></p>

<h3 id="variables-">Variables <a name="variable"></a></h3>
<h4 id="variable-types-">Variable Types <a name="vartypes"></a></h4>
<p>The table below shows what data types are supported as well as their memory size.</p>

<figure>
  <img src="/img/posts/excel-vba/data_types.jpg" class="blg-img" alt="List of data types" />
</figure>

<p><br /></p>

<h4 id="declaring-variables-">Declaring Variables <a name="decvar"></a></h4>
<p>You declare variables by using the keyword <code class="highlighter-rouge">dim</code> followed by <code class="highlighter-rouge">variable name</code> then keyword <code class="highlighter-rouge">as</code> followed by <code class="highlighter-rouge">data type</code>; <code class="highlighter-rouge">dim hello as String</code>, <code class="highlighter-rouge">dim x as Integer</code>. Once declared you assign a stored value by using the <code class="highlighter-rouge">=</code> operator.</p>

<figure>
  <img src="/img/posts/excel-vba/vardemo.jpg" class="blg-img" alt="Declare and assign variables" />
  <figcaption>Declare and assign variables</figcaption>
</figure>

<p><br /></p>

<h4 id="call-a-procedure-">Call A Procedure <a name="callpro"></a></h4>
<p>To call another procedure (function) use the <code class="highlighter-rouge">Call</code> keyword followed by the procedure’s name, ex:<code class="highlighter-rouge">Call myMethod</code>. If there are variables declared within the called procedure then the values will be out of scope and not recognized by the compiler.</p>

<figure>
  <img src="/img/posts/excel-vba/callpro.jpg" class="blg-img" alt="Call another procedure" />
  <figcaption>Calling another procedure within a procedure</figcaption>
</figure>

<p><br /></p>

<h4 id="public-and-private-variables-">Public and Private Variables <a name="pubpriv"></a></h4>
<p>When setting a variable as <code class="highlighter-rouge">Public</code> the variable will retain its data and can be used throughout any other module. When setting a variable as <code class="highlighter-rouge">Private</code> the variable can only be accessed only within the module it is initialized in.</p>

<figure>
  <img src="/img/posts/excel-vba/pubpriv.jpg" class="blg-img" alt="Public and Private Variables" />
  <figcaption>Declaring public and private variables</figcaption>
</figure>

<p><br /></p>

<h4 id="using-constants-">Using Constants <a name="constants"></a></h4>
<p>Declare constants by using the <code class="highlighter-rouge">Const</code> keyword and you must assign data when declaring. Constants cannot be changed.
<code class="highlighter-rouge">Const PI as Double = 3.14</code>. You can also make the constants public or private.</p>

<p><br /></p>

<h4 id="concatenate-strings-">Concatenate Strings <a name="concat"></a></h4>
<p>You can combine two or more strings by using the <code class="highlighter-rouge">&amp;</code> symbol. This will also work to combine string variables. <code class="highlighter-rouge">text = "Hello " &amp; "World!"</code></p>

<p><br /></p>

<h4 id="pass-by-value-vs-reference-">Pass by Value vs Reference <a name="valref"></a></h4>
<p>When passing values into a procedure use the keywords <code class="highlighter-rouge">ByVal</code> &amp; <code class="highlighter-rouge">ByRef</code> to specify how you are passing the variables through. By value means that only the value is being passed and will not change once the procedure is ended. By reference means that any changes made will change the original value.</p>

<figure>
  <img src="/img/posts/excel-vba/refval.jpg" class="blg-img" alt="By reference and by value examples" />
  <figcaption>ByVal does not change but ByRef does change</figcaption>
</figure>

<p><br /></p>

<h3 id="editor-toolbars-and-menu-">Editor Toolbars and Menu <a name="toolmenu"></a></h3>
<h4 id="file-menu-">File Menu <a name="file"></a></h4>
<p>The file menu you have your basics save, print, remove. The <code class="highlighter-rouge">Remove module</code> will delete your file. You can <code class="highlighter-rouge">Export</code> your code and save it as a <code class="highlighter-rouge">.bas</code> file. You can also <code class="highlighter-rouge">Import</code> your written code from a .bas file.</p>

<p><br /></p>

<h4 id="edit-menu-">Edit Menu <a name="edit"></a></h4>
<p>In the edit menu the <code class="highlighter-rouge">List Properties/Methods (ctrl + j)</code> will open a dropdown menu with all of the available options of properties and methods. Another tool is to use the <code class="highlighter-rouge">Bookmarks</code> to save the location of a particular code so you can reference it later if need be.</p>

<p><br /></p>

<h4 id="view-menu-">View Menu <a name="view"></a></h4>
<p>View menu has the some useful tools other than adding different menu items to your toolbar. <code class="highlighter-rouge">Last Position</code> will move the cursor back to it previous location. <code class="highlighter-rouge">Definition</code> opens up a window with a list of all the properties/methods along with a description on each. <code class="highlighter-rouge">Object Browser</code> is similar to definition but displays a list of all the objects.</p>

<p>The <code class="highlighter-rouge">Immediate</code> button will open up a window where you can change temporary change your code; such as, change a variable’s data. Also in the <code class="highlighter-rouge">Immediate</code> window you can write <code class="highlighter-rouge">debug.Print varName</code> to display the result.</p>

<p>The <code class="highlighter-rouge">Locals</code> window will display information about all of the local variables in the current modules. The <code class="highlighter-rouge">Watch Window</code> allows you to select a variable to shadow and displays its changes throughout the code (good for debugging). It will also display vast amount of information that can be toggling the <code class="highlighter-rouge">+</code> symbol next to it.</p>

<p><br /></p>

<h4 id="debug-menu-">Debug Menu <a name="dbug"></a></h4>
<p>The <code class="highlighter-rouge">Debug</code> menu is really important as it will help you find and fix errors in your code. <code class="highlighter-rouge">Step Into</code> when run goes into any methods and runs the code line by line. If you wanted to get out of a method <code class="highlighter-rouge">Step Out</code> will get you out of any methods/subs. <code class="highlighter-rouge">Run to Cursor</code> will run the code from beginning to where your cursor is.</p>

<p>In addition is you can also add, edit, remove watches. <code class="highlighter-rouge">Toggle Breakpoint</code> will run the code up to the breakpoint then wait for you to resume the code until the next breakpoint or end. <code class="highlighter-rouge">Set Next Statement</code> will allow you to temporary skip code and jump to the marker (yellow arrow) and start running code from that line.</p>

<p><br /></p>

<h3 id="logic-">Logic <a name="logic"></a></h3>
<h4 id="last-row-">Last Row <a name="lastrow"></a></h4>
<p>To find the last row of the data set in your workbook combine these methods and it will return the last row value as an integer ex: <code class="highlighter-rouge">lastRow = Cells(Rows.Count, 1).End(xlup).Row</code>. What this does is it goes through all the rows in column one. Then it goes up until it finds the first cell with a value in it.</p>

<figure>
  <img src="/img/posts/excel-vba/lastrow.jpg" class="blg-img" alt="Find the last row with data" />
  <figcaption>This method helps find the last row with data</figcaption>
</figure>

<p><br /></p>

<h4 id="last-column-">Last Column <a name="lastcolumn"></a></h4>
<p>To find the last column of the data set in your workbook cmbine these methods and it will return the last column value as an integer ex: <code class="highlighter-rouge">lastColumn = Cells(1, Columns.Count).End(xlToLeft).Column</code>. What this does is it goes to to the last column then back left to the first cell with a value in it.</p>

<figure>
  <img src="/img/posts/excel-vba/lastcol.jpg" class="blg-img" alt="Find the last column with data" />
  <figcaption>This method helps find the last column with data</figcaption>
</figure>

<p><br /></p>

<h4 id="next-row-">Next Row <a name="nextrow"></a></h4>
<p>To get the next row you simply use the formula for the last row and add 1 to it ex: <code class="highlighter-rouge">lastRow = Cells(Rows.Count, 1).End(xlup).Row + 1</code></p>

<p><br /></p>

<h4 id="record-macro-">Record Macro <a name="macro"></a></h4>
<p>Excel give you the ability to record a macro while you perform the function on the physical workbook. It then creates a module with the code written. See sample below on steps to recording a macro.</p>

<figure>
  <img src="/img/posts/excel-vba/macro1.jpg" class="blg-img" alt="Hit record" />
  <figcaption>Step 1: Hit record macro on dev tab</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/macro2.jpg" class="blg-img" alt="Enter macros name and other info" />
  <figcaption>Step 2: Enter macros name and other info</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/macro3.jpg" class="blg-img" alt="Work on your workbook" />
  <figcaption>Step 3: Work on your workbook until finished</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/macro4.jpg" class="blg-img" alt="Stop recording" />
  <figcaption>Step 4: Stop recording</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/macro5.jpg" class="blg-img" alt="Your code will be in modules" />
  <figcaption>Step 5: You can review and edit your code</figcaption>
</figure>

<p><br /></p>

<h4 id="absolute-vs-relative-reference-">Absolute vs Relative Reference <a name="abrelref"></a></h4>
<p>Absolute reference is when objects are referring to a specific cell, which is hard coded. When the macro is run it will always reference to that specific cell. Relative reference dynamically changes the location of the cell by using the current position of the cursor as the starting point. To use relative reference make sure to check the <code class="highlighter-rouge">Use Relative References</code> button.</p>

<figure>
  <img src="/img/posts/excel-vba/abrelref.jpg" class="blg-img" alt="Absolute vs relative reference" />
  <figcaption>Absolute on top and Relative on bottom</figcaption>
</figure>

<p><br /></p>

<h4 id="with-and-end-">With and End <a name="endwith"></a></h4>
<p>If you have multiple commands to execute within a cell its best to use a <code class="highlighter-rouge">With</code> &amp; <code class="highlighter-rouge">End With</code> block to save repetitive typing and keeping clean code.</p>

<figure>
  <img src="/img/posts/excel-vba/endwith.jpg" class="blg-img" alt="With block to save repetitive code" />
  <figcaption>With selects ActiveWorkbook.Workshe... instead of repeating it several times</figcaption>
</figure>

<p><br /></p>

<h4 id="comparison-operators-">Comparison Operators <a name="compare"></a></h4>
<ul>
  <li><code class="highlighter-rouge">=</code> equal to</li>
  <li><code class="highlighter-rouge">&lt;&gt;</code> not equal to</li>
  <li><code class="highlighter-rouge">&lt;</code> less than</li>
  <li><code class="highlighter-rouge">&gt;</code> greater than</li>
  <li><code class="highlighter-rouge">&lt;=</code> less than or equal to</li>
  <li><code class="highlighter-rouge">&gt;=</code> greater than or equal to</li>
</ul>

<p><br /></p>

<h4 id="if-then-">If Then <a name="ifthen"></a></h4>
<p>Use the <code class="highlighter-rouge">If</code> <code class="highlighter-rouge">Then</code> keywords to create and execute a conditional statement; if the condition is true. You need to always need to close the conditional block by using <code class="highlighter-rouge">End If</code>.</p>

<figure>
  <img src="/img/posts/excel-vba/ifthen.jpg" class="blg-img" alt="If then conditionals" />
  <figcaption>Use if then keywords to create conditional statements</figcaption>
</figure>

<p>If you just have one condition to check you can write the if statement, without the <code class="highlighter-rouge">Then</code> in one line ex: <code class="highlighter-rouge">If Range("c3") = 11 Then MsgBox "YOLO"</code>.</p>

<p><br /></p>

<h4 id="is-not-equal-to--not">Is Not Equal To &amp; Not<a name="isnot"></a></h4>
<p>You can use the <code class="highlighter-rouge">&lt;&gt;</code> is not equal to operator to create the opposite of the equals operator ex: <code class="highlighter-rouge">If range("A1").value &lt;&gt; 1 Then</code> etc… You can also you the keyword <code class="highlighter-rouge">Not</code> after <code class="highlighter-rouge">If</code> to say if cell value is not equal to “x” then execute these commands.</p>

<figure>
  <img src="/img/posts/excel-vba/isnot.jpg" class="blg-img" alt="Use &lt;&gt; operator or Not keyword" />
  <figcaption></figcaption>
</figure>

<p><br /></p>

<h4 id="else-">Else <a name="else"></a></h4>
<p>Use the <code class="highlighter-rouge">Else</code> keyword to create a nested conditional statement so that if all the <code class="highlighter-rouge">If Then</code> statements are false then the <code class="highlighter-rouge">Else</code> statement will run.</p>

<figure>
  <img src="/img/posts/excel-vba/else.jpg" class="blg-img" alt="Use if then else block" />
  <figcaption></figcaption>
</figure>

<p><br /></p>

<h4 id="else-if-">Else If <a name="elseif"></a></h4>
<p>Use the <code class="highlighter-rouge">ElseIf</code> keyword to combine as many conditional statement you need. The structure will start with <code class="highlighter-rouge">If condition Then</code> then <code class="highlighter-rouge">ElseIf condition Then</code> and finally <code class="highlighter-rouge">Else</code></p>

<figure>
  <img src="/img/posts/excel-vba/elseif.jpg" class="blg-img" alt="Using else if" />
  <figcaption></figcaption>
</figure>

<p><br /></p>

<h4 id="comparative-operators-text--numbers-">Comparative Operators Text &amp; Numbers <a name="comptxtnum"></a></h4>
<p>When comparing numbers, if the cell data is text then the compiler will accept it and convert it to a number; however, to prevent this in the <code class="highlighter-rouge">If</code> statement use method <code class="highlighter-rouge">IsNumeric(cellLocation)</code> ex: <code class="highlighter-rouge">IsNumeric(Range("a1"))</code>. The <code class="highlighter-rouge">And</code> keyword must be used to allow for multiple conditionals where both statements must be true in order for statement to execute.</p>

<figure>
  <img src="/img/posts/excel-vba/comptxtnum.jpg" class="blg-img" alt="Compare numbers only" />
  <figcaption>If not specificed the compiler will accept text as numbers</figcaption>
</figure>

<p><br /></p>

<h4 id="goto--labels-">GoTo &amp; Labels <a name="golabel"></a></h4>
<p>If you have parts of your code that need to be skipped for whatever reason then the <code class="highlighter-rouge">GoTo</code> keyword along with labels allow you to do this. The label must be spelled the same and must include at <code class="highlighter-rouge">:</code> after it.</p>

<figure>
  <img src="/img/posts/excel-vba/goto.jpg" class="blg-img" alt="Use GoTo command to skip over blocks of code" />
  <figcaption>Use GoTo and labels to skip over code if needed</figcaption>
</figure>

<p><br /></p>

<h4 id="select-case-">Select Case <a name="selcase"></a></h4>
<p>Similar to If Else the <code class="highlighter-rouge">Select Case</code> keywords are good for conditionals on a specific value. It makes code cleaner and much easier to read/write than If Else. You must end the block by using <code class="highlighter-rouge">End Select</code>.</p>

<figure>
  <img src="/img/posts/excel-vba/selectcase.jpg" class="blg-img" alt="Use the select case keywords for conditions" />
  <figcaption>Use case statements for single value conditionals</figcaption>
</figure>

<p><br /></p>

<h4 id="message-box-options-">Message Box Options <a name="msgbox"></a></h4>
<p>The message box object can be modified to have several other options; such as, yes and no buttons. Utilizing the options will allow you to create a more visual and user friendly experience. To enable the options you use the function <code class="highlighter-rouge">MsgBox("text", options)</code>. It is a good idea usually to store the user’s answer into a variable.</p>

<figure>
  <img src="/img/posts/excel-vba/msgbox.jpg" class="blg-img" alt="Use message box for more visual experience" />
  <figcaption>Use the additional options for message box</figcaption>
</figure>

<p><br /></p>

<h4 id="relative-positioning-">Relative Positioning <a name="relpos"></a></h4>
<p>You can select any cell from your current cursor position using the <code class="highlighter-rouge">Selection</code> and <code class="highlighter-rouge">Offset(row, column)</code> functions. You don’t have to use selection only you can use the <code class="highlighter-rouge">Cells</code> or <code class="highlighter-rouge">Range</code> object with the <code class="highlighter-rouge">Offset</code>.</p>

<figure>
  <img src="/img/posts/excel-vba/relpos.jpg" class="blg-img" alt="Use relative positioning" />
  <figcaption>Offset will allow you to change cell location</figcaption>
</figure>

<p><br /></p>

<h3 id="loops--reports-">Loops &amp; Reports <a name="loop"></a></h3>
<h4 id="for-loop-">For Loop <a name="forl"></a></h4>
<p>The <code class="highlighter-rouge">For</code> <code class="highlighter-rouge">Next</code> is a good loop to cycle through a row or column. The formula for <code class="highlighter-rouge">For</code> loop is <code class="highlighter-rouge">For counter_var = starting_value To ending_value</code> and to increment the counter use <code class="highlighter-rouge">Next counter_var</code>.</p>

<figure>
  <img src="/img/posts/excel-vba/forloop.jpg" class="blg-img" alt="Sample For Loop" />
  <figcaption>Sample for loop</figcaption>
</figure>

<p><br /></p>

<h4 id="simple-report-">Simple Report <a name="report"></a></h4>
<p>Using the for loop and conditionals you can create a simple report to grab specific data from the worksheet to be able to print out. The below example will grab data of anything under $500 in sales. To create a new line use the keyword <code class="highlighter-rouge">vbNewLine</code>.</p>

<figure>
  <img src="/img/posts/excel-vba/report1.jpg" class="blg-img" alt="Sample report out put to message box" />
  <figcaption>Sample report output to message box</figcaption>
</figure>

<p><br /></p>

<h4 id="input-box-">Input Box <a name="input"></a></h4>
<p>Input boxes allow you to receive some data from the user. Use the function <code class="highlighter-rouge">inputbox("prompt", Title, "default value")</code> and set it equal to a variable to store the value.</p>

<figure>
  <img src="/img/posts/excel-vba/input.jpg" class="blg-img" alt="Input box" />
  <figcaption>Input Box</figcaption>
</figure>

<p>You can convert text to number a couple of ways. The first way is to add <code class="highlighter-rouge">0</code> to the the number ex: <code class="highlighter-rouge">"200" + 0</code>.</p>

<figure>
  <img src="/img/posts/excel-vba/txt2num.jpg" class="blg-img" alt="Convert text to number" />
  <figcaption>Convert text to number</figcaption>
</figure>

<p>Sometimes you will have debug error if you cancel out of an input box. To prevent this use the <code class="highlighter-rouge">On Error Resume Next</code> to allow the code to continue on error. Also use an <code class="highlighter-rouge">If</code> statement to check that the input is not <code class="highlighter-rouge">Empty Then Exit Sub</code>.</p>

<figure>
  <img src="/img/posts/excel-vba/inputempty.jpg" class="blg-img" alt="Input is empty" />
  <figcaption>Prevent empty input value from causing errors</figcaption>
</figure>

<p><br /></p>

<h4 id="button-">Button <a name="button"></a></h4>
<p>To add a button which executes other code when use the graphical interface in the <code class="highlighter-rouge">insert</code> tab and preferably use <code class="highlighter-rouge">ActiveX Controls</code> ones. Drag and hold until the size is what you like. To edit the properties right click and select <code class="highlighter-rouge">properties</code>.</p>

<figure>
  <img src="/img/posts/excel-vba/button1.jpg" class="blg-img" alt="Button on insert menu" />
  <figcaption>Select graphical editor</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/button2.jpg" class="blg-img" alt="Edit Properties" />
  <figcaption>Customize and edit button</figcaption>
</figure>

<p>To link it to a function use the <code class="highlighter-rouge">Call</code> keyword so that when the button is clicked it executes the function. Double click on the button to open up VBA editor.</p>

<figure>
  <img src="/img/posts/excel-vba/button3.jpg" class="blg-img" alt="Code for button" />
  <figcaption>Code for the button</figcaption>
</figure>

<p>Another way to make buttons is to use the <code class="highlighter-rouge">Shapes</code> in the <code class="highlighter-rouge">Insert</code> tab. You can then right click and assign a specific macro to it. This allows your buttons to good visually instead of the generic dark gray square buttons.</p>

<p><br /></p>

<h4 id="report-">Report <a name="reportprint"></a></h4>
<p>Below is an example on creating a simple printable report. It is important to use the <code class="highlighter-rouge">Set</code> keyword to link worksheets to a variable.</p>

<figure>
  <img src="/img/posts/excel-vba/reportp1.jpg" class="blg-img" alt="Label worksheet tabs" />
  <figcaption>Step 1: label worksheet tabs</figcaption>
</figure>

<p>Use <code class="highlighter-rouge">Dim</code> to declare variables and link them to specific data in the workbook.</p>

<figure>
  <img src="/img/posts/excel-vba/reportp2.jpg" class="blg-img" alt="Set worksheets to variables" />
  <figcaption>Step 2: set variables to link to specific worksheet</figcaption>
</figure>

<p>Since we are now using more than one worksheets we must specify which worksheet we will be using before using functions such as <code class="highlighter-rouge">Cells</code> <code class="highlighter-rouge">Range</code> etc.</p>

<figure>
  <img src="/img/posts/excel-vba/reportp3.jpg" class="blg-img" alt="Specify worksheet and code logic" />
  <figcaption>Step 3: Specify which worksheet you are using. Code the logic. </figcaption>
</figure>

<p>After running the report once the original report will stay. If you add remove data and run the report again you may have data in there from previous runs. it is best to create a function to clear out the old report before running the new one. Use the <code class="highlighter-rouge">ClearContents</code> object for that.</p>

<figure>
  <img src="/img/posts/excel-vba/reportp4.jpg" class="blg-img" alt="Clear out old report" />
  <figcaption>Step 4: Clear out old report before running new one </figcaption>
</figure>

<p>To automate the movement to the report tab so that the user doesn’t have to manually find it or go there. If sheet is hidden use the <code class="highlighter-rouge">Visible</code> object and set it to <code class="highlighter-rouge">true</code>. Then you will have to use <code class="highlighter-rouge">Select</code> object to move user’s view to the worksheet.</p>

<figure>
  <img src="/img/posts/excel-vba/reportp5.jpg" class="blg-img" alt="Show report worksheet" />
  <figcaption>Step 6: Show the report worksheet</figcaption>
</figure>

<p><br /></p>

<h4 id="printing-">Printing <a name="printing"></a></h4>
<p>You can set a worksheet on print preview mode by using the <code class="highlighter-rouge">PrintPreview</code> object ex: <code class="highlighter-rouge">wrksht.PrintPreview</code>. It will then automatically create and print preview of the worksheet.</p>

<p>To send the worksheet out to the default printer use the <code class="highlighter-rouge">PrintOut(args)</code> object. One property <code class="highlighter-rouge">copies: 1</code> should be set to one unless you want more.</p>

<p><br /></p>

<h4 id="reverse-for-loop-">Reverse For Loop <a name="reverseloop"></a></h4>
<p>To go backwards in a loop use the <code class="highlighter-rouge">Step</code> keyword instead of <code class="highlighter-rouge">Then</code>.</p>

<figure>
  <img src="/img/posts/excel-vba/reverseforloop.jpg" class="blg-img" alt="Reverse for loop" />
  <figcaption>Reverse for loop</figcaption>
</figure>

<p><br /></p>

<h4 id="for-each-loop-">For Each Loop <a name="foreach"></a></h4>
<p>The for each loop will loop through an entire group of objects. One example is the named table you can loop through the entire table. Use the keywords <code class="highlighter-rouge">For Each cell In Range("letters")</code> and then to continue use <code class="highlighter-rouge">Next cell</code>. You can exit the loop if need be you can use <code class="highlighter-rouge">Exit For</code>.</p>

<figure>
  <img src="/img/posts/excel-vba/foreach.jpg" class="blg-img" alt="For Each" />
  <figcaption>For each loop</figcaption>
</figure>

<p><br /></p>

<h4 id="do-loop-">Do Loop <a name="doloop"></a></h4>
<p>Do loop keeps looping through until a condition is met. Do loops can go into an infinite loop if you do not give a condition that reaches true and breaks the loop. Use keyword <code class="highlighter-rouge">Do</code> and <code class="highlighter-rouge">Loop</code>.</p>

<figure>
  <img src="/img/posts/excel-vba/doloop.jpg" class="blg-img" alt="Do Loop" />
  <figcaption>Do Loop</figcaption>
</figure>

<p><br /></p>

<h4 id="do-loop--1">Do Loop <a name="dountil"></a></h4>
<p>The <code class="highlighter-rouge">Do Until</code> forces you to specify a condition so that when true it will break out of the loop. You can still have an infinite loop if the condition never reaches true. It checks the condition before entering the loop.</p>

<figure>
  <img src="/img/posts/excel-vba/dountil.jpg" class="blg-img" alt="Do Until" />
  <figcaption>Do Until</figcaption>
</figure>

<p><br /></p>

<h4 id="loop-until-">Loop Until <a name="loopuntil"></a></h4>
<p>The <code class="highlighter-rouge">Loop Until</code> forces you to specify a condition at the end of the loop; however, it will run the loop block at least once before checking the condition.</p>

<figure>
  <img src="/img/posts/excel-vba/loopuntil.jpg" class="blg-img" alt="Loop Until" />
  <figcaption>Loop Until</figcaption>
</figure>

<p><br /></p>

<h4 id="do-while-">Do While <a name="dowhile"></a></h4>
<p>The <code class="highlighter-rouge">Do While</code> loop keeps running while the condition is true. This is different such that the condition is already true while the previous loops the condition was false.</p>

<figure>
  <img src="/img/posts/excel-vba/dowhile.jpg" class="blg-img" alt="Do While" />
  <figcaption>Do While</figcaption>
</figure>

<p><br /></p>

<h4 id="loop-while-">Loop While <a name="loopwhile"></a></h4>
<p>The <code class="highlighter-rouge">Do Loop While</code> is similar to the loop until such that, the loop code will run at least once before checking the conditon.</p>

<figure>
  <img src="/img/posts/excel-vba/loopwhile.jpg" class="blg-img" alt="Loop While" />
  <figcaption>Loop While</figcaption>
</figure>

<p><br /></p>

<h4 id="exit-loops-">Exit Loops <a name="exitdo"></a></h4>
<p>To exit loops anywhere in between use the <code class="highlighter-rouge">Exit Do</code> keyword.</p>

<figure>
  <img src="/img/posts/excel-vba/exitdo.jpg" class="blg-img" alt="Exit Do" />
  <figcaption>Exit Do</figcaption>
</figure>

<p><br /></p>

<h3 id="events-">Events <a name="events"></a></h3>
<h4 id="intro-events--selection-change-">Intro Events &amp; Selection Change <a name="introevent"></a></h4>
<p>Worksheet events occur whenever something happens on the worksheet. There are other methods to trigger a macro besides just tying it to a button.</p>

<p>In the VBA editor change from <code class="highlighter-rouge">General</code> to <code class="highlighter-rouge">Worksheet</code> and you will see a sub for <code class="highlighter-rouge">Worksheet_SelectionChange</code>. Every time you click on a different cell of the worksheet this sub will run the code inside it.</p>

<figure>
  <img src="/img/posts/excel-vba/intro1.jpg" class="blg-img" alt="Intro to events" />
  <figcaption>Worksheet_SelectionChange sub will run each time you select cell on worksheet</figcaption>
</figure>

<p>The sub passes in an argument called <code class="highlighter-rouge">Target</code> that will get the value of the cell that the cursor is moved to. You can use <code class="highlighter-rouge">target.properties</code> to access information about the targeted cell.</p>

<figure>
  <img src="/img/posts/excel-vba/intro2.jpg" class="blg-img" alt="Intro to events" />
  <figcaption>Use target variable to extract information from the highlighted cell</figcaption>
</figure>

<p><br /></p>

<h4 id="activate-event-">Activate Event <a name="activate"></a></h4>
<p>The <code class="highlighter-rouge">activate</code> event will trigger when you change worksheet tabs. You must select <code class="highlighter-rouge">Worksheet</code> and then <code class="highlighter-rouge">Activate</code>.</p>

<figure>
  <img src="/img/posts/excel-vba/activate.jpg" class="blg-img" alt="Activate event" />
  <figcaption>Use activate to trigger when you switch tabs</figcaption>
</figure>

<p><br /></p>

<h4 id="deactivate-event-">Deactivate Event <a name="deactivate"></a></h4>
<p>The <code class="highlighter-rouge">deactivate</code> event will trigger when you leave current worksheet tab for another one. You must select <code class="highlighter-rouge">Worksheet</code> and then <code class="highlighter-rouge">Deactivate</code>.</p>

<figure>
  <img src="/img/posts/excel-vba/deactivate.jpg" class="blg-img" alt="Deactivate event" />
  <figcaption>Use activate to trigger when you switch tabs</figcaption>
</figure>

<p><br /></p>

<h4 id="before-delete-">Before Delete <a name="beforedel"></a></h4>
<p>The <code class="highlighter-rouge">BeforeDelete</code> event will trigger before deleting a worksheet. It doesn’t prevent you from deleting just executes the code before you delete. You must select <code class="highlighter-rouge">Worksheet</code> and then <code class="highlighter-rouge">BeforeDelete</code>.</p>

<figure>
  <img src="/img/posts/excel-vba/beforedel.jpg" class="blg-img" alt="Before Delete" />
  <figcaption>Before delete</figcaption>
</figure>

<p><br /></p>

<h4 id="before-double-click-">Before Double Click <a name="beforedouble"></a></h4>
<p>The <code class="highlighter-rouge">Before Double Click</code> event will trigger before the double click action takes place. There is an additional argument called <code class="highlighter-rouge">Cancel</code> that is passed in and its of a boolean value. If cancel is false after the double click code runs the cursor will then place cursor ready to edit contents of the cell clicked; to stop this make cancel true.</p>

<figure>
  <img src="/img/posts/excel-vba/beforedouble.jpg" class="blg-img" alt="Before Double Click" />
  <figcaption>Before Double Click</figcaption>
</figure>

<p><br /></p>

<h4 id="before-right-click-">Before Right Click <a name="beforerightclk"></a></h4>
<p>The <code class="highlighter-rouge">Before Right Click</code> event will execute code before the original right click function works. Setting cancel to true here will prevent the original right click menu from popping up after.</p>

<figure>
  <img src="/img/posts/excel-vba/beforerightclk.jpg" class="blg-img" alt="Before Right Click" />
  <figcaption>Before Right Click</figcaption>
</figure>

<p><br /></p>

<h4 id="calculates-event-">Calculates Event <a name="calculate"></a></h4>
<p>The <code class="highlighter-rouge">Calculates</code> event will recompute all the formulas for the worksheet. The example given by Microsoft was to autofit the columns A through F.</p>

<figure>
  <img src="/img/posts/excel-vba/calculate.jpg" class="blg-img" alt="Calculate Event" />
  <figcaption>Calculate Event</figcaption>
</figure>

<p><br /></p>

<h4 id="disable-events-">Disable Events <a name="disableevent"></a></h4>
<p>You can disable events on a workbook by using the <code class="highlighter-rouge">Application.EnableEvents</code> object and setting it to false.</p>

<figure>
  <img src="/img/posts/excel-vba/disableevent.jpg" class="blg-img" alt="Disable Event" />
  <figcaption>Disable Event</figcaption>
</figure>

<p><br /></p>

<h4 id="change-event-">Change Event <a name="changeevent"></a></h4>
<p>Change event will run whenever any cell value changes.</p>

<figure>
  <img src="/img/posts/excel-vba/changeevent.jpg" class="blg-img" alt="Change Event" />
  <figcaption>Change Event checking single cell value</figcaption>
</figure>

<p>You can also compare with a range instead of just a single cell. You will need to use the <code class="highlighter-rouge">intersect</code> function to compare your target and then the range to compare it to.</p>

<figure>
  <img src="/img/posts/excel-vba/changeevent2.jpg" class="blg-img" alt="Change Event Intersect" />
  <figcaption>Change Event comparing a range</figcaption>
</figure>

<p><br /></p>

<h4 id="hyperlinks-">Hyperlinks <a name="links"></a></h4>
<p>Follow hyperlinks will get a hyperlink in a cell and pass it as an argument. Using the <code class="highlighter-rouge">target</code> you can select from a list of properties to edit and manipulate the hyperlink.</p>

<figure>
  <img src="/img/posts/excel-vba/hyperlink.jpg" class="blg-img" alt="Hyperlink" />
  <figcaption>Hyperlink</figcaption>
</figure>

<p><br /></p>

<h3 id="workbook-events-">Workbook Events <a name="wrkbookevent"></a></h3>
<h4 id="workbook-open-">Workbook Open <a name="wrkbookopen"></a></h4>
<p>Workbook events are like worksheet events but they effect the entire workbook. In the VBA editor select the <code class="highlighter-rouge">ThisWorkbook</code> icon to create macros for the entire workbook. The <code class="highlighter-rouge">Open</code> event runs as soon as the workbook is open.</p>

<figure>
  <img src="/img/posts/excel-vba/openevent.jpg" class="blg-img" alt="Open Event" />
  <figcaption>Open Event</figcaption>
</figure>

<p><br /></p>

<h4 id="workbook-activate-">Workbook Activate <a name="wrkbookactivate"></a></h4>
<p>Workbook <code class="highlighter-rouge">Activate</code> event runs once you click on the workbook. If you have 2 workbooks open and switch between them each time you lose focus and come back the <code class="highlighter-rouge">Activate</code> macro will run.</p>

<p><br /></p>

<h4 id="before-save-">Before Save <a name="beforesave"></a></h4>
<p>Workbook <code class="highlighter-rouge">Before Save</code> will trigger when you click the save button and then execute the macro before saving. If cancel is set to true then it won’t save.</p>

<figure>
  <img src="/img/posts/excel-vba/save.jpg" class="blg-img" alt="Before Save Event" />
  <figcaption>Before Save Event</figcaption>
</figure>

<p><br /></p>

<h4 id="after-save-">After Save <a name="aftersave"></a></h4>
<p>Workbook <code class="highlighter-rouge">After Save</code> will trigger after the workbook tries saving. It returns a <code class="highlighter-rouge">Success</code> argument that is true/false depending on if the workbook saved successfully.</p>

<figure>
  <img src="/img/posts/excel-vba/aftrsave.jpg" class="blg-img" alt="After Save Event" />
  <figcaption>After Save Event</figcaption>
</figure>

<p><br /></p>

<h4 id="before-close-">Before close <a name="beforeclose"></a></h4>
<p>The <code class="highlighter-rouge">Before Close</code> event runs before you close the workbook. It also passes in the <code class="highlighter-rouge">Cancel</code> argument as a boolean.</p>

<figure>
  <img src="/img/posts/excel-vba/beforeclose.jpg" class="blg-img" alt="Before Close Event" />
  <figcaption>Before Close Event</figcaption>
</figure>

<p><br /></p>

<h4 id="before-print-">Before Print <a name="beforeprint"></a></h4>
<p>The <code class="highlighter-rouge">Before Print</code> event runs before you print a worksheet. It also passes in the <code class="highlighter-rouge">Cancel</code> argument that if set to true won’t allow anyone to print. This is good in preventing confidential data for being allowed to print.</p>

<p><br /></p>

<h4 id="workbook-deactivate-">Workbook Deactivate <a name="workbookdeactivate"></a></h4>
<p>The <code class="highlighter-rouge">Workbook Deactivate</code> event is similar to the <code class="highlighter-rouge">Workbook Activate</code> event but triggers right after you lose focus of the workbook.</p>

<p><br /></p>

<h4 id="new-chart-">New Chart <a name="newchart"></a></h4>
<p>The <code class="highlighter-rouge">New Chart</code> event is when you create a new chart. The <code class="highlighter-rouge">Ch</code> argument is a chart object. Whenever you create a new chart inside the workbook the values assigned will become the default values of the chart. If you need to figure out how to adjust some of the other chart properties its best to record a macro and then reverse engineer it.</p>

<figure>
  <img src="/img/posts/excel-vba/newchart.jpg" class="blg-img" alt="New Chart Event" />
  <figcaption>New Chart Event</figcaption>
</figure>

<p><br /></p>

<h4 id="new-sheet-">New Sheet <a name="newsheet"></a></h4>
<p>The <code class="highlighter-rouge">New Sheet</code> event runs everytime you create a new worksheet. You can edit the properties of the new sheet by using the passed in object <code class="highlighter-rouge">Sh</code>. For example you can edit the font type on all cells to be says bold ex: <code class="highlighter-rouge">Sh.Cells.Font.Bold = True</code>.</p>

<p><br /></p>

<h4 id="sheet-activate-">Sheet Activate <a name="sheetactive"></a></h4>
<p>The <code class="highlighter-rouge">Sheet Activate</code> event triggers each time you are in focus on the worksheet. The object passed in <code class="highlighter-rouge">Sh</code> is the current sheet.</p>

<p><br /></p>

<h4 id="sheet-before-delete-">Sheet Before Delete <a name="sheetbeforedelete"></a></h4>
<p>The <code class="highlighter-rouge">Sheet Before Delete</code> runs when any worksheet on the workbook is deleted. There is no <code class="highlighter-rouge">Cancel</code> variable to prevent deletion.</p>

<p><br /></p>

<h4 id="sheet-before-double-click-">Sheet Before Double Click <a name="sheetdoubleclick"></a></h4>
<p>The <code class="highlighter-rouge">Sheet Before Double Click</code> runs when you double click anywhere on the entire workbook. The arguments passed are worksheet, target, and cancel options.</p>

<p><br /></p>

<h4 id="sheet-before-right-click-">Sheet Before Right Click <a name="sheetrightclick"></a></h4>
<p>The <code class="highlighter-rouge">Sheet Before Double Click</code> runs when you right click anywhere on the entire workbook. The arguments passed are the worksheet, target, and cancel options.</p>

<p><br /></p>

<h4 id="sheet-calculation-">Sheet Calculation <a name="sheetcalculate"></a></h4>
<p>The <code class="highlighter-rouge">Sheet Calculation</code> runs when you edit any formulas anywhere in the entire workbook.</p>

<p><br /></p>

<h4 id="sheet-change-">Sheet Change <a name="sheetchange"></a></h4>
<p>The <code class="highlighter-rouge">Sheet Calculation</code> runs when you change any value of a cell in the entire workbook</p>

<p><br /></p>

<h4 id="sheet-deactivate-">Sheet Deactivate <a name="sheetdeactivate"></a></h4>
<p>The <code class="highlighter-rouge">Sheet Deactivate</code> code runs when you leave the current worksheet to another one.</p>

<figure>
  <img src="/img/posts/excel-vba/sheetdeactivate.jpg" class="blg-img" alt="Sheet Deactivate" />
  <figcaption>Sheet Deactivate</figcaption>
</figure>

<p><br /></p>

<h4 id="sheet-selection-change-">Sheet Selection Change <a name="sheetselectionchange"></a></h4>
<p>The <code class="highlighter-rouge">Sheet Selection Change</code> runs anytime you move your cursor to a new cell position anywhere in the entire workbook.</p>

<p><br /></p>

<h4 id="window-activate-">Window Activate <a name="windowactivate"></a></h4>
<p>The <code class="highlighter-rouge">Window Activate</code> only triggers when the workbook itself is activated and in focus.</p>

<p><br /></p>

<h4 id="window-deactivate-">Window Deactivate <a name="windowdeactivate"></a></h4>
<p>The <code class="highlighter-rouge">Window Activate</code> only triggers when the workbook itself is deactivated and loses focus.</p>

<p><br /></p>

<h4 id="window-resize-">Window Resize <a name="windowresize"></a></h4>
<p>The <code class="highlighter-rouge">Window Resize</code> runs each time you resize the workbook. It passes in a window object <code class="highlighter-rouge">Wn</code> that you can get height, width, size and other information about the window.</p>

<p><br /></p>

<p>Active X forms allow a lot more customization and give you a ton more information than a simple form control. You are able to change everything from the name to the mouse cursor. To get the information <code class="highlighter-rouge">right click</code> and select <code class="highlighter-rouge">properties</code>. Also active x allows you to select from various different types of events.</p>

<figure>
  <img src="/img/posts/excel-vba/formx.jpg" class="blg-img" alt="Active X Form" />
  <figcaption>Active X Form</figcaption>
</figure>

<p>Below is an example of the code you can use to create a simple wage calculator. With a click, double click, or other events of a button you can compute multiple cells. This is also useful so that formulas cannot be accidentally erased when hardcoded into the excel cell.</p>

<figure>
  <img src="/img/posts/excel-vba/formcalc.jpg" class="blg-img" alt="Active X Form Calculator" />
  <figcaption>Active X Form Calculator</figcaption>
</figure>

<p><br /></p>

<h4 id="key-downpress-event-">Key Down/Press Event <a name="keydown"></a></h4>
<p>The keydown and press events occur whenever a key has been pressed and will return an integer value corresponding to the key. <a href="https://msdn.microsoft.com/en-us/library/aa243025(v=vs.60).aspx">Click Here For Complete List of KeyCodes</a>. The variables that are passed in is the <code class="highlighter-rouge">KeyCode</code> as an integer and <code class="highlighter-rouge">Shift</code> which checks to see if shift was held during the event.</p>

<figure>
  <img src="/img/posts/excel-vba/keypress.jpg" class="blg-img" alt="Key Pressed Example" />
  <figcaption>Key Pressed Example</figcaption>
</figure>

<p>The key press event is similar to keydown but it returns a value based on the ASCII code value. <a href="http://www.asciitable.com/">Click Here For The List of ASCII Codes</a>.</p>

<p><br /></p>

<h4 id="mouse-move--application-statusbar-">Mouse Move &amp; Application Statusbar <a name="mouse"></a></h4>
<p>The mouse move event triggers when your mouse moves onto the object. The additional arguments passed give you the x and y coordinates.</p>

<figure>
  <img src="/img/posts/excel-vba/mouse.jpg" class="blg-img" alt="Mouse Movement" />
  <figcaption>Mouse Movement</figcaption>
</figure>

<p>You can add a status bar message by using the <code class="highlighter-rouge">Application.Statusbar</code> keyword. This will provide additional information to the user. You can set the value to false to get ride of the statusbar message.</p>

<figure>
  <img src="/img/posts/excel-vba/mouseapp.jpg" class="blg-img" alt="Application Statusbar" />
  <figcaption>Application Statusbar</figcaption>
</figure>

<p><br /></p>

<h4 id="mouse-updown--left-middle-right-click-">Mouse Up/Down &amp; Left Middle Right Click <a name="mouseupdown"></a></h4>
<p>You can get specific on when to execute the code depending on after mouse has been clicked or as soon as it is on the down phase. Left, Right and Middle clicks are pretty self explanatory.</p>

<figure>
  <img src="/img/posts/excel-vba/mouseclick.jpg" class="blg-img" alt="Mouse Click" />
  <figcaption>Mouse Down Event</figcaption>
</figure>

<p><br /></p>

<h4 id="gotfocus-and-lostfocus-">GotFocus and LostFocus <a name="focus"></a></h4>
<p>The <code class="highlighter-rouge">GotFocus</code> event occurs when you click on the button. The <code class="highlighter-rouge">LostFocus</code> event triggers when you click away or tab away from the button.</p>

<p><br /></p>

<h4 id="checkbox-">Checkbox <a name="checkbox"></a></h4>
<p>The checkbox object only allows for a <code class="highlighter-rouge">true</code> or <code class="highlighter-rouge">false</code> value. Using the keyword <code class="highlighter-rouge">Me</code> is equal to this and reference’s the current worksheet. You can combine other forms and use the checkbox’s value.</p>

<figure>
  <img src="/img/posts/excel-vba/checkbox.jpg" class="blg-img" alt="Checkbox" />
  <figcaption>Checkbox by using its value</figcaption>
</figure>

<p>You don’t need to be dependent on a button to utilize the checkbox. You can trigger codes based on the interaction with the checkbox.</p>

<figure>
  <img src="/img/posts/excel-vba/checkbox2.jpg" class="blg-img" alt="Checkbox example" />
  <figcaption>Checkbox by user interaction</figcaption>
</figure>

<p><br /></p>

<h4 id="linked-cell-">Linked Cell <a name="linkcell"></a></h4>
<p>You can link a specific cell to a form. For example the checkbox’s value can be linked to cell “a1” and whenever you check/uncheck the box the value in “a1” will change. To link a cell right click the form and in properties under <code class="highlighter-rouge">LinkedCell</code> enter the cell value.</p>

<figure>
  <img src="/img/posts/excel-vba/linkcell.jpg" class="blg-img" alt="Linked Cell" />
  <figcaption>Link a cell to a form</figcaption>
</figure>

<p><br /></p>

<h4 id="option-button-">Option Button <a name="optionbutton"></a></h4>
<p>The option button is more of a grouping setting; such that, you should use more than one. When the option button’s are grouped together you may only select one. To group option buttons you need to first <code class="highlighter-rouge">cntrl + click</code> to select the options you want in the group then click on <code class="highlighter-rouge">properties</code> in the developer tab. Fill out the property called <code class="highlighter-rouge">GroupName</code> to create the group.</p>

<figure>
  <img src="/img/posts/excel-vba/option1.jpg" class="blg-img" alt="Creating a group list" />
  <figcaption>Creating a group list</figcaption>
</figure>

<p>To neatly format the icons you can select the option buttons and go to <code class="highlighter-rouge">Format</code> and under <code class="highlighter-rouge">Align</code> select the appropirate function in most cases its <code class="highlighter-rouge">Algin Left</code>. To manually align for the small mm offsets you can use the arrow keys. Another tip on selecting the entire group as one unit.</p>

<p>Below is a sample program on how you can use conditions with the optionbox forms.</p>

<figure>
  <img src="/img/posts/excel-vba/option2.jpg" class="blg-img" alt="Move selection app" />
  <figcaption>Movie selection app</figcaption>
</figure>

<p>You can create a checker to see that the user in fact selected the required conditions in order to run. Have an If statement checking to see that at least one of the choices is selected; use the <code class="highlighter-rouge">Or</code> keyword in the conditional <code class="highlighter-rouge">IF x or y or z</code>. Another way is you can set the confirmation button to invisible and when the conditions are met change it to visible.</p>

<p><br /></p>

<h4 id="spin-button--textbox-">Spin Button &amp; Textbox <a name="spinbutton"></a></h4>
<p>The spin button are arrow buttons that are either up and down or left and right and cycle through a list of choices. The two most common events are spin up and spin down.</p>

<figure>
  <img src="/img/posts/excel-vba/spin.jpg" class="blg-img" alt="Spinner" />
  <figcaption>Spin form</figcaption>
</figure>

<p>When cells are empty the compiler automatically thinks its 0 this is why a textbox is great form to be combined with the spinner. Textbox always contains a text value so adding a number to it will not work and throws an error. You can use the <code class="highlighter-rouge">On Error Resume Next</code> and/or check to see if text is empty. Another method is to check to see if it is a numerical value using <code class="highlighter-rouge">IsNumeric</code>.</p>

<figure>
  <img src="/img/posts/excel-vba/spin2.jpg" class="blg-img" alt="Spinner" />
  <figcaption>Spin form</figcaption>
</figure>

<p>Spin buttons can also be used for more than just numbers. You can convert the number into a date and use that to display the date type. You can use the <code class="highlighter-rouge">CDate()</code> function to convert into a date.</p>

<figure>
  <img src="/img/posts/excel-vba/spin3.jpg" class="blg-img" alt="Spinner" />
  <figcaption>Convert textbox into a date</figcaption>
</figure>

<p><br /></p>

<h4 id="labels-">Labels <a name="labels1"></a></h4>
<p>You can create labels to make your sections more descriptive. You can also add a picture and change the look and feel of the label in the <code class="highlighter-rouge">Properties</code>.</p>

<figure>
  <img src="/img/posts/excel-vba/labels1.jpg" class="blg-img" alt="Label" />
  <figcaption>Using Labels</figcaption>
</figure>

<p><br /></p>

<h4 id="combobox-fill-with-list-fill-range-">ComboBox Fill with List Fill Range <a name="combo"></a></h4>
<p>The list fill box is good to create a dropdown list of categories for the user to select from. You setup a group and in properties set the group name into <code class="highlighter-rouge">ListFillRange</code>. The combo box can have a list and or textbox.</p>

<figure>
  <img src="/img/posts/excel-vba/list.jpg" class="blg-img" alt="ComboBox" />
  <figcaption>Lists</figcaption>
</figure>

<p>Sometimes you will need to have a dynamic range so that when new records are added it automatically picks up. To do this click <code class="highlighter-rouge">alt + I + N + D</code> for the <code class="highlighter-rouge">names manager</code> edit the value to offset(starting cell, move down #, left or right #, how many rows wide? use counta(get count of nonblank cells) - header(1), how many column wide (1))</p>

<figure>
  <img src="/img/posts/excel-vba/dynamicrange.jpg" class="blg-img" alt="Dynamic Range" />
  <figcaption>Dynamic Range</figcaption>
</figure>

<p>With combo boxes you can have multiple columns. In the ComboBox <code class="highlighter-rouge">properties</code> change the <code class="highlighter-rouge">column count</code> and expand your named range to include more than one columns.</p>

<p>There are more customizable ways to add items to your combobox. Using the <code class="highlighter-rouge">.AddItem</code> function. To clear up all entries inside the combobox use the <code class="highlighter-rouge">.clear</code> function.</p>

<figure>
  <img src="/img/posts/excel-vba/additem.jpg" class="blg-img" alt="Add Item" />
  <figcaption>Add items to combo box</figcaption>
</figure>

<p>If you have multiple columns and need to add items you will have to use some array manipulation. Arrays start with 0.</p>

<figure>
  <img src="/img/posts/excel-vba/additem2.jpg" class="blg-img" alt="Add Item" />
  <figcaption>Add multiple columns to combo box</figcaption>
</figure>

<p><br /></p>

<h4 id="list-box-">List Box <a name="listbox"></a></h4>
<p>List box is a box with a list in it. You can specify the group name in the <code class="highlighter-rouge">properties</code> as well as the number of columns. You can adjust the column widths also just put <code class="highlighter-rouge">;</code> in between each column. If its a named range you can turn on the property of <code class="highlighter-rouge">ColumnHeads</code> to true.</p>

<figure>
  <img src="/img/posts/excel-vba/listbox.jpg" class="blg-img" alt="listbox" />
  <figcaption>List Box</figcaption>
</figure>

<p>The list box takes the value of whatever line the user clicks on. Columns are in array format starting with 0. You can have a linked cell or you can put events on it using click events.</p>

<p>To use the other columns data you will have to use the list and find the index.</p>

<figure>
  <img src="/img/posts/excel-vba/listbox2.jpg" class="blg-img" alt="listbox" />
  <figcaption>Extracting data from list box</figcaption>
</figure>

<p>To make the listbox dynamic you can use the <code class="highlighter-rouge">AddItem</code> function. You can also hide columns but keep value by changing the property of the column’s width and setting it to <code class="highlighter-rouge">0pt</code></p>

<p><br /></p>

<h4 id="scrollbar-">Scrollbar <a name="scroll"></a></h4>
<p>The scrollbar can be used to scroll through either data or values. Using the properties menu you can change the min and max properties. You can also change the small changes (when arrow is pressed) or large change when the middle of the scroll bar is pressed.</p>

<p><br /></p>

<h4 id="image-control-">Image Control <a name="image"></a></h4>
<p>You can create an image and use that as a button as a control. One use is to link it to a webpage using <code class="highlighter-rouge">FollowHyperlink ("http://www.google.com")</code></p>

<p><br /></p>

<h4 id="toggle-button-">Toggle Button <a name="toggle"></a></h4>
<p>The toggle button has only 2 values a <code class="highlighter-rouge">true</code> or <code class="highlighter-rouge">false</code> and you can click it to make it true and click again to make it false.</p>

<p><br /></p>

<h3 id="user-forms-">User Forms <a name="userforms"></a></h3>
<h4 id="hide-show--unload-">Hide Show &amp; Unload <a name="hideshow"></a></h4>
<p>To get to the userforms menu click on the icon and a new editor will open up as well as creating a new forms folder. To get form toolbox you can go to <code class="highlighter-rouge">View</code> then <code class="highlighter-rouge">Toolbox</code> to bring it up.</p>

<figure>
  <img src="/img/posts/excel-vba/userform.jpg" class="blg-img" alt="User form menu" />
  <figcaption>User form menu</figcaption>
</figure>

<p>You can hide and show a user form by using the <code class="highlighter-rouge">Hide</code> and <code class="highlighter-rouge">Show</code> commands.</p>

<figure>
  <img src="/img/posts/excel-vba/userform2.jpg" class="blg-img" alt="Hide Show" />
  <figcaption>User form menu</figcaption>
</figure>

<p><br /></p>

<h4 id="status-box-">Status Box <a name="status"></a></h4>
<p>User form boxes also have <code class="highlighter-rouge">properties</code> you can use <code class="highlighter-rouge">F4</code> shortcut. To populate data into the form use the <code class="highlighter-rouge">Initialize</code> event to load data on startup. You can either use the <code class="highlighter-rouge">AddItem</code> function or alternatively go to properties window and selected a range or named source into the <code class="highlighter-rouge">RowSource</code> box.</p>

<figure>
  <img src="/img/posts/excel-vba/userform2.jpg" class="blg-img" alt="Hide Show" />
  <figcaption>User form menu</figcaption>
</figure>

<p><br /></p>

<h4 id="new-data-">New Data <a name="newdata"></a></h4>
<p>From the user entry from you can create a button to update the data records. To do this you find the last row of the data set then extract each data from the form and add it to the excel sheet. If you have numbers you will need to change the format to number.</p>

<figure>
  <img src="/img/posts/excel-vba/newdata.jpg" class="blg-img" alt="Add new data" />
  <figcaption>Add data to data set</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/newdata2.jpg" class="blg-img" alt="Add new data result" />
  <figcaption>Added new data row to data set</figcaption>
</figure>

<p><br /></p>

<h4 id="convert-text-to-numbers-">Convert Text to Numbers <a name="txt2num"></a></h4>
<p>When you extract data from the user form it will be in text format and will need to be converted if you need it to be any other type such as numbers. The best way to do this is to +, -, /* or // to change the text into a number.</p>

<p><br /></p>

<h4 id="tab-order-">Tab Order <a name="taborder"></a></h4>
<p>To set the tab index order so that when a user is typing and hits tab it goes to the next box you need to change the properties of each text box in sequential order. Change the <code class="highlighter-rouge">TabIndex</code> field and start with 0, 1, 2 and so on.</p>

<figure>
  <img src="/img/posts/excel-vba/taborder.jpg" class="blg-img" alt="tab index" />
  <figcaption>Tab Index and order</figcaption>
</figure>

<p><br /></p>

<h4 id="default-value-">Default Value <a name="defval"></a></h4>
<p>To set a default value in a textbox set it in the <code class="highlighter-rouge">caption</code> property.</p>

<p><br /></p>

<h4 id="prevent-duplicates-">Prevent Duplicates <a name="duplicate"></a></h4>
<p>Prevent duplicate records by creating a loop and checking to see if ID created matches.</p>

<figure>
  <img src="/img/posts/excel-vba/taborder.jpg" class="blg-img" alt="tab index" />
  <figcaption>Tab Index and order</figcaption>
</figure>

<p><br /></p>

<h4 id="edit-mode-">Edit Mode <a name="editmode"></a></h4>
<p>Your form should also be able to edit a record. To do this you should create an <code class="highlighter-rouge">edit</code> button and combine it with a dropdown list of all the records (RowSource). You should create a dynamic named range.</p>

<figure>
  <img src="/img/posts/excel-vba/edit1.jpg" class="blg-img" alt="Create Button" />
  <figcaption>Create edit button</figcaption>
</figure>

<p>Once the record has been added its best to clear out and blank the text boxes by just setting them to blank string. To <code class="highlighter-rouge">edit</code> create a loop and compare a unique ID to see if it matches. You may need to convert number to text and the easiest way to do that is just add  <code class="highlighter-rouge">&amp; ""</code> to convert it to a text. When saving it would update the record.</p>

<figure>
  <img src="/img/posts/excel-vba/edit2.jpg" class="blg-img" alt="Edit existing record" />
  <figcaption>Edit existing record</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/edit3.jpg" class="blg-img" alt="edit3" />
  <figcaption>When saving you need to stop firing the change event</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/edit4.jpg" class="blg-img" alt="User Form" />
  <figcaption>User Form</figcaption>
</figure>

<p><br /></p>

<h4 id="reports-w-filters-">Reports w Filters <a name="reportfilter"></a></h4>
<p>You can create another userform that can extract the data and create a useful report.</p>

<figure>
  <img src="/img/posts/excel-vba/reportfill.jpg" class="blg-img" alt="report filter" />
  <figcaption>User Reports</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/reportfill1.jpg" class="blg-img" alt="report filter" />
  <figcaption>User Reports</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/reportfill2.jpg" class="blg-img" alt="report filter" />
  <figcaption>User Reports</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/reportfill3.jpg" class="blg-img" alt="report filter" />
  <figcaption>Dynamic Filters</figcaption>
</figure>

<figure>
  <img src="/img/posts/excel-vba/reportfill4.jpg" class="blg-img" alt="report filter" />
  <figcaption>Dynamic Filters</figcaption>
</figure>

<p>Remember to clear our last report before running another one.</p>

<figure>
  <img src="/img/posts/excel-vba/reportfill4.jpg" class="blg-img" alt="Clear Report" />
  <figcaption>Clear Report</figcaption>
</figure>

<p><br /></p>

    <button id="scroll-top"><span class="glyphicon glyphicon-menu-up"></span></button>
  </div>


<div id="disqus_thread"></div>
<script>
/**
* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
*/

// var disqus_config = function () {
//   this.page.url = /blog/programming/excel-vba;         // Replace PAGE_URL with your page's canonical URL variable
//   //this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
// };

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//pratikshah.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">

      <div id="social-media" class="footer-col footer-col-3 center">

        <!-- <div id="twitter-btn">
          <a href="https://twitter.com/pratikshah" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @pratikshah</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
        </div> -->

        <ul class="social-media-list center">
          
          <li>
            <a href="https://github.com/pratikmshah" class="icon-social" title="GitHub">
  <img src="/img/icons/github-blk.png">
  <img src="/img/icons/github-clr.png">
</a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/pratikshah" class="icon-social" title="Twitter">
  <img src="/img/icons/twt-blk.png">
  <img src="/img/icons/twt-clr.png">
</a>


          </li>
          

          
          <li>
            <a href="https://linkedin.com/in/pratikmshah" class="icon-social" title="LinkedIn">
  <img src="/img/icons/lnkdn-blk.png">
  <img src="/img/icons/lnkdn-clr.png">
</a>

          </li>
          

          
          <li>
            <a href="https://instagram.com/pratikshah_" class="icon-social" title="Instagram">
  <img src="/img/icons/insta-blk.png">
  <img src="/img/icons/insta-clr.png">
</a>

          </li>
          

          
          <li>
            <a href="mailto:pratik.t.shah@gmail.com" class="icon-social" title="E-Mail">
  <img src="/img/icons/email-blk.png">
  <img src="/img/icons/email-clr.png">
</a>

          </li>
          
        </ul>
      </div>

     <div class="center">
      <p class="footer-copyw">This site is powered by <a href="https://jekyllrb.com/">Jekyll</a></p>
     </div>

    </div>

  </div>

</footer>


  </body>

</html>
